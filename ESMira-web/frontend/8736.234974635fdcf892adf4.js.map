{"version":3,"file":"8736.234974635fdcf892adf4.js","mappings":"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","sources":["webpack://ESMira/./src/frontend/ts/loader/AboutESMiraLoader.ts","webpack://ESMira/./src/frontend/ts/pages/about.tsx","webpack://ESMira/./src/frontend/ts/site/SectionContent.tsx","webpack://ESMira/./src/frontend/ts/widgets/DashElement.tsx","webpack://ESMira/./src/frontend/ts/widgets/DashRow.tsx","webpack://ESMira/./src/frontend/ts/widgets/NotCompatibleIcon.tsx","webpack://ESMira/./src/frontend/ts/widgets/TitleRow.tsx"],"sourcesContent":["import {URL_ABOUT_ESMIRA_JSON, URL_ABOUT_ESMIRA_PUBLICATIONS_JSON, URL_ABOUT_ESMIRA_STRUCTURE_JSON} from \"../constants/urls\";\nimport {Lang} from \"../singletons/Lang\";\nimport {PromiseCache} from \"../singletons/PromiseCache\";\nimport {Requests} from \"../singletons/Requests\";\n\nexport interface AboutESMiraInterface {\n\tstructure: {\n\t\trepository_link: string,\n\t\tpage_about: {\n\t\t\tid: string\n\t\t\tdash?: {\n\t\t\t\tid: string,\n\t\t\t\tscreenshots?: string,\n\t\t\t\ticon: string\n\t\t\t}[],\n\t\t\turls?: {\n\t\t\t\tid: string,\n\t\t\t\thref: string\n\t\t\t}[]\n\t\t}[],\n\t\tpage_screenshots: {\n\t\t\tid: string\n\t\t\timages: {\n\t\t\t\tsrc: string,\n\t\t\t\tdesc?: string\n\t\t\t}[][]\n\t\t}[],\n\t\tpage_instances: {\n\t\t\ttitle: string,\n\t\t\tdescription: string,\n\t\t\tlogo: string,\n\t\t\turl: string\n\t\t}[]\n\t}\n\ttranslations: Record<string, string>\n}\n\nexport interface ESMiraPublicationsInterface {\n\tyears: number[],\n\tentries: Record<number, Publication[]>\n}\n\ninterface Publication {\n\tyear: number,\n\ttitle: string\n\turl: string\n}\n\nexport class AboutESMiraLoader {\n\tpublic static load(): Promise<AboutESMiraInterface> {\n\t\treturn PromiseCache.get(\"aboutESMira\", async () => {\n\t\t\tconst structure = await Requests.loadRaw(URL_ABOUT_ESMIRA_STRUCTURE_JSON)\n\t\t\ttry {\n\t\t\t\tconst lang = await Requests.loadRaw(URL_ABOUT_ESMIRA_JSON.replace(\"%s\", Lang.code))\n\t\t\t\treturn {\n\t\t\t\t\tstructure: JSON.parse(structure),\n\t\t\t\t\ttranslations: JSON.parse(lang)\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch(e) {\n\t\t\t\tconst fallbackLang = await Requests.loadRaw(URL_ABOUT_ESMIRA_JSON.replace(\"%s\", \"en\"))\n\t\t\t\treturn {\n\t\t\t\t\tstructure: JSON.parse(structure),\n\t\t\t\t\ttranslations: JSON.parse(fallbackLang)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\t\n\tpublic static loadPublications(): Promise<ESMiraPublicationsInterface> {\n\t\treturn PromiseCache.get(\"ESMiraPublications\", async () => {\n\t\t\tconst publicationsArray: Publication[] = JSON.parse(await Requests.loadRaw(URL_ABOUT_ESMIRA_PUBLICATIONS_JSON))\n\t\t\t\n\t\t\tconst publications: Record<number,Publication[]> = {}\n\t\t\tconst years: number[] = []\n\t\t\tfor(let publication of publicationsArray) {\n\t\t\t\tif(!publications.hasOwnProperty(publication.year)) {\n\t\t\t\t\tpublications[publication.year] = []\n\t\t\t\t\tyears.push(publication.year)\n\t\t\t\t}\n\t\t\t\tpublications[publication.year].push(publication)\n\t\t\t}\n\t\t\tfor(const year in publications) {\n\t\t\t\tpublications[year].sort((a, b) => {\n\t\t\t\t\tif(a.title > b.title)\n\t\t\t\t\t\treturn 1\n\t\t\t\t\telse if(a.title < b.title)\n\t\t\t\t\t\treturn -1\n\t\t\t\t\telse\n\t\t\t\t\t\treturn 0\n\t\t\t\t})\n\t\t\t}\n\t\t\tyears.sort((a, b) => {\n\t\t\t\tif(a < b)\n\t\t\t\t\treturn 1\n\t\t\t\telse if(a > b)\n\t\t\t\t\treturn -1\n\t\t\t\telse\n\t\t\t\t\treturn 0\n\t\t\t})\n\t\t\t\n\t\t\treturn {\n\t\t\t\tyears: years,\n\t\t\t\tentries: publications\n\t\t\t}\n\t\t})\n\t}\n}","import {SectionContent} from \"../site/SectionContent\";\nimport m, {Vnode} from \"mithril\";\nimport {DashRow} from \"../widgets/DashRow\";\nimport {DashElement} from \"../widgets/DashElement\";\nimport {Lang} from \"../singletons/Lang\";\nimport repositorySvg from \"../../imgs/dashIcons/github.svg?raw\"\nimport googlePng from \"../../imgs/google-play-badge-en.png\"\nimport applePng from \"../../imgs/apple-store-badge-en.png\"\nimport {TitleRow} from \"../widgets/TitleRow\";\nimport {Section} from \"../site/Section\";\nimport {AboutESMiraInterface, AboutESMiraLoader} from \"../loader/AboutESMiraLoader\";\n\nexport class Content extends SectionContent {\n\tprivate about: AboutESMiraInterface\n\tpublic static preLoad(_section: Section): Promise<any>[] {\n\t\treturn [\n\t\t\tAboutESMiraLoader.load()\n\t\t]\n\t}\n\t\n\tconstructor(section: Section, about: AboutESMiraInterface) {\n\t\tsuper(section)\n\t\tthis.about = about\n\t}\n\t\n\tpublic title(): string {\n\t\treturn Lang.get(\"about_esmira\")\n\t}\n\t\n\tpublic getView(): Vnode<any, any> {\n\t\tconst structure = this.about.structure\n\t\tconst translations = this.about.translations\n\t\treturn <div>\n\t\t\t<div class=\"center horizontalPadding\">\n\t\t\t\t<p class=\"justify lineSize\">{translations[\"about_text\"]}</p>\n\t\t\t\t<a href=\"https://play.google.com/store/apps/details?id=at.jodlidev.esmira\" target=\"_blank\"><img alt=\"Android\" src={googlePng}/></a>\n\t\t\t\t&nbsp;\n\t\t\t\t<a href=\"https://apps.apple.com/gb/app/esmira/id1538774594\" target=\"_blank\"><img alt=\"iOS\" src={applePng}/></a>\n\t\t\t</div>\n\t\t\t\n\t\t\t<br/>\n\t\t\t\n\t\t\t{DashRow(\n\t\t\t\tDashElement(null, {template: {title: Lang.get(\"screenshots\")}, href: this.getUrl(\"screenshots\")}),\n\t\t\t\tDashElement(null, {template: {title: Lang.get(\"publications_using_esmira\")}, href: this.getUrl(\"publications\")}),\n\t\t\t\tDashElement(\"stretched\", {\n\t\t\t\t\thref: structure.repository_link,\n\t\t\t\t\ttemplate: {\n\t\t\t\t\t\ttitle: translations[\"use_for_own_studies\"],\n\t\t\t\t\t\tmsg: translations[\"esmira_own_server_get_started\"],\n\t\t\t\t\t\ticon: m.trust(repositorySvg)\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t)}\n\t\t\t<br/>\n\t\t\t\n\t\t\t{structure.page_about.map((entry) =>\n\t\t\t\t<div>\n\t\t\t\t\t{TitleRow(translations[entry.id])}\n\t\t\t\t\t{entry.dash && DashRow(\n\t\t\t\t\t\t...entry.dash.map((dash) =>\n\t\t\t\t\t\t\tDashElement(null, {\n\t\t\t\t\t\t\t\ttemplate: {\n\t\t\t\t\t\t\t\t\ttitle: translations[`${dash.id}_title`],\n\t\t\t\t\t\t\t\t\tmsg: m.trust(translations[`${dash.id}_desc`]),\n\t\t\t\t\t\t\t\t\tinnerLinkTitle: dash.screenshots && Lang.get(\"screenshots\"),\n\t\t\t\t\t\t\t\t\tinnerLinkHref: dash.screenshots && this.getUrl(dash.screenshots),\n\t\t\t\t\t\t\t\t\ticon: m.trust(dash.icon)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\t\t\t\t\t)}\n\t\t\t\t\t\n\t\t\t\t\t{entry.urls?.map((url) =>\n\t\t\t\t\t\t<div class=\"line center\">\n\t\t\t\t\t\t\t<a class=\"verticalPadding showArrow\" target=\"_blank\" href={url.href}>{translations[url.id]}</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t}\n}","import m, {Vnode} from \"mithril\";\nimport {Section} from \"./Section\";\nimport {Study} from \"../data/study/Study\";\nimport {StaticValues} from \"./StaticValues\";\nimport {ObservablePrimitive} from \"../observable/ObservablePrimitive\";\nimport {Questionnaire} from \"../data/study/Questionnaire\";\nimport {DynamicValues} from \"./DynamicValues\";\nimport {PrimitiveType} from \"../observable/types/PrimitiveType\";\nimport {AccountPermissions} from \"../admin/AccountPermissions\";\nimport {AdminToolsInterface} from \"../admin/AdminToolsInterface\";\nimport {Admin} from \"../admin/Admin\";\n\nexport interface SectionAlternative {\n\ttitle: string\n\ttarget: string | false\n\theader?: boolean\n}\n\n/**\n * The dynamic content class of each section. Each section extends this class. SectionContent is a child of {@link Section} which takes care of loading and\n * displaying SectionContent.\n * Important: Changes to Observables in data.dataTypes will lead to {@link m.redraw()} (see {@link StudyLoader.constructor()}).\n * BUT, changes to the dom will happen asynchronously. In other words: The philosophy is, that {@link getView()} always works with fresh (not cached) data\n * and always constructs the full section (instead of just updating it). Mithril will take care of keeping track of changes and updates the dom when necessary.\n *\n * Method calls are guaranteed to be in this order:\n * 1. {@link preLoad()}\n * 2. {@link preInit()}\n * 3. {@link title()}, {@link titleExtra()}, {@link getView()}\n * Have a look at the implementation in {@link Section.load()} for more information\n */\nexport abstract class SectionContent {\n\tpublic readonly section: Section\n\t\n\tconstructor(section: Section) {\n\t\tthis.section = section\n\t}\n\t\n\t/**\n\t * Is always called before anything else.\n\t * @returns Promise array. The section will be in loading state and not other methods will be called as long as these Promises are loading\n\t */\n\tpublic static preLoad(_section: Section): Promise<any>[] {\n\t\treturn []\n\t}\n\t\n\t/**\n\t * Is guaranteed to run AFTER all promises in {@link preLoad()} are finished\n\t * @param _responses Holds the return values of each Promise from {@link preLoad()}\n\t */\n\tpublic preInit(... _responses: any): Promise<any> {\n\t\treturn Promise.resolve()\n\t}\n\tpublic hasAlternatives(): boolean {\n\t\treturn false\n\t}\n\tpublic getAlternatives(): SectionAlternative[] | Promise<SectionAlternative[]> | null {\n\t\treturn null\n\t}\n\t\n\tpublic abstract title(): string\n\t\n\tpublic titleExtra(): Vnode<any, any> | null {\n\t\treturn null\n\t}\n\t\n\t\n\tpublic getDynamic<T extends PrimitiveType>(key: keyof DynamicValues, defaultValue: T): ObservablePrimitive<T> {\n\t\treturn this.section.getDynamic(key, defaultValue)\n\t}\n\tpublic setDynamic<T extends PrimitiveType>(key: keyof DynamicValues, newValue: T) {\n\t\tthis.section.siteData.dynamicValues.setChild(key, newValue)\n\t}\n\tpublic getStaticInt<T extends StaticValues>(key: T): number | null {\n\t\treturn this.section.getStaticInt(key)\n\t}\n\tpublic getStaticString<T extends StaticValues>(key: T): string | null {\n\t\treturn this.section.getStaticString(key)\n\t}\n\tprotected getStudyOrNull(id: number = this.getStaticInt(\"id\") ?? -1): Study | null {\n\t\tconst studies = this.section.siteData.studyLoader.getStudies()\n\t\tif(id == -1)\n\t\t\treturn studies.getCount() == 1 ? (studies.getFirst() || null) : null\n\t\t\n\t\treturn studies.getEntry(id) ?? null\n\t}\n\tpublic getStudyOrThrow(id: number = this.getStaticInt(\"id\") ?? -1): Study {\n\t\tconst study = this.getStudyOrNull(id)\n\t\tif(!study)\n\t\t\tthrow new Error(`Study ${id} does not exist!`)\n\t\treturn study\n\t}\n\tprotected getQuestionnaireOrNull(qId: number = this.getStaticInt(\"qId\") ?? -1, study: Study | null = this.getStudyOrNull()): Questionnaire | null {\n\t\tif(!study)\n\t\t\treturn null\n\t\tconst questionnaires = this.getStudyOrThrow().questionnaires.get()\n\t\tfor(const questionnaire of questionnaires) {\n\t\t\tif(questionnaire.internalId.get() == qId)\n\t\t\t\treturn questionnaire\n\t\t}\n\t\treturn null\n\t}\n\tprotected getQuestionnaireOrThrow(qId: number = this.getStaticInt(\"qId\") ?? -1): Questionnaire {\n\t\tconst questionnaire = this.getQuestionnaireOrNull(qId, this.getStudyOrThrow())\n\t\tif(!questionnaire)\n\t\t\tthrow new Error(`Questionnaire ${qId} does not exist!`)\n\t\telse\n\t\t\treturn questionnaire\n\t}\n\t\n\tpublic getTools(): AdminToolsInterface {\n\t\treturn this.section.getTools()\n\t}\n\tpublic getAdmin(): Admin {\n\t\treturn this.section.getAdmin()\n\t}\n\t\n\tpublic hasPermission(name: keyof AccountPermissions, studyId: number): boolean {\n\t\treturn this.getAdmin().isLoggedIn() && (this.getTools().hasPermission(name, studyId) ?? false)\n\t}\n\t\n\tpublic getUrl(name: string, depth: number = this.section.depth): string {\n\t\treturn `${this.section.getHash(depth)}/${name}`\n\t}\n\tpublic goTo(target: string): void {\n\t\twindow.location.hash = \"#\"+target;\n\t}\n\tpublic newSection(target: string, depth: number = this.section.depth): void {\n\t\twindow.location.hash = depth == -1 ? target : `${this.section.getHash(depth)}/${target}`\n\t}\n\t\n\t\n\t/**\n\t * Remember: Values or references of observables should NOT be cached (also when the value is an observable itself)\n\t * It would lead to new values not being updated properly on {@link m.redraw()}\n\t *\n\t * Examples:\n\t * You can cache: {@link StudyLoader.studyCache}. Because this observable is readonly and will never be replaced\n\t * You can NOT cache {@link StudyLoader.studyCache.get()} or {@link getStudyOrThrow()} or {@link getStudy().questionnaires.get()[2]}.\n\t * \t\tBecause all study entries in StudyLoader might have been replaced or removed between {@link m.redraw()}\n\t *\n\t * You can cache: {@link SiteData.dynamicValues[\"accessKey\"]} because {@link Container} uses Singletons (see {@link Container.getOrCreateObs()})\n\t * You can not cache: {@link SiteData.dynamicValues[\"accessKey\"].get()} because its value might change\n\t *\n\t * In conclusion: {@link getView()} always needs to work with fresh values. Starting, for example, with {@link getStudyOrThrow()}\n\t */\n\tpublic abstract getView(): Vnode<any, any>\n\t\n\tpublic destroy(): void {\n\t\t//do nothing\n\t}\n}","import m, {Vnode} from \"mithril\"\nimport {NotCompatibleIcon, PossibleDevices} from \"./NotCompatibleIcon\";\n\ntype DashTemplateOptions = {\n\ttitle: string\n\ticon?: Vnode<any, any>\n\tnoCompatibilityIcon?: PossibleDevices[]\n\tmsg?: string | Vnode<any, any>\n\tinnerLinkTitle?: string\n\tinnerLinkHref?: string\n}\n\ntype DashContainerOptions = \"stretched\" | \"cramped\" | \"vertical\" | \"horizontal\" | null\nexport type DashViewOptions = {\n\tdisabled?: boolean\n\tonclick?: (e: MouseEvent) => void\n\thref?: string\n\tshowAsClickable?: boolean\n\tfloating?: boolean\n\tfloatingRight?: boolean\n\thighlight?: boolean\n\tsmall?: boolean\n\ttemplate?: DashTemplateOptions\n\tcontent?: Vnode<any, any>\n}\n\nfunction DashTemplateView(options: DashTemplateOptions): Vnode<any, any> {\n\treturn (\n\t\t<div>\n\t\t\t{(options.icon || options.noCompatibilityIcon) &&\n\t\t\t\t<div class=\"dashIcon\">\n\t\t\t\t\t{options.icon}\n\t\t\t\t\t{options.noCompatibilityIcon && NotCompatibleIcon(... options.noCompatibilityIcon)}\n\t\t\t\t</div>\n\t\t\t}\n\t\t\t\n\t\t\t<div class=\"dashTitle\">{options.title}</div>\n\t\t\t{options.msg && <p class=\"dashMsg\">{options.msg}</p>}\n\t\t\t{options.innerLinkTitle && options.innerLinkHref && <a class=\"link\" href={options.innerLinkHref}>{options.innerLinkTitle}</a>}\n\t\t</div>\n\t)\n}\n\nfunction DashElementView(options: DashViewOptions): Vnode<any, any> {\n\tlet classString = \"dashEl\"\n\tif(options.floatingRight)\n\t\tclassString += \" floating right\"\n\telse if(options.floating)\n\t\tclassString += \" floating\"\n\t\n\tif(options.small)\n\t\tclassString += \" small\"\n\tif(options.highlight)\n\t\tclassString += \" highlight\"\n\tif(options.disabled)\n\t\tclassString += \" disabled\"\n\t\n\tlet view: Vnode<any, any>\n\tif(options.content)\n\t\tview = options.content\n\telse if(options.template)\n\t\tview = DashTemplateView(options.template)\n\telse\n\t\tview = <div class=\"highlight\">Missing Dash Information</div>\n\t\n\tif(options.href) {\n\t\treturn <a target={options.href.startsWith(\"http\") ? \"_blank\" : \"\"} class={`${classString} dashLink`} href={options.href}>{view}</a>\n\t}\n\telse if(options.onclick)\n\t\treturn <a class={`${classString} dashLink`} onclick={options.onclick}>{view}</a>\n\telse if(options.showAsClickable)\n\t\treturn <a class={`${classString} dashLink`}>{view}</a>\n\telse {\n\t\tview.attrs[\"className\"] = `${classString} ${view.attrs.hasOwnProperty(\"className\") ? view.attrs[\"className\"] : \"\"}`\n\t\treturn view\n\t}\n}\n\nfunction getNewClassString(size: DashContainerOptions, oldClassString: string): string {\n\tif(size)\n\t\toldClassString += \" \" + size\n\treturn oldClassString\n}\n\nexport function DashElement(\n\tsize: DashContainerOptions,\n\t... options: (DashViewOptions | false)[]\n): Vnode<any, any> {\n\tif(options.length == 1) {\n\t\tif(!options[0])\n\t\t\treturn <div></div>\n\t\t\n\t\tconst view =  DashElementView(options[0])\n\t\tview.attrs[\"className\"] = getNewClassString(size, view.attrs[\"className\"])\n\t\treturn view\n\t}\n\telse {\n\t\tconst classString = getNewClassString(size, \"multipleChildren\")\n\t\treturn <div class={classString}>\n\t\t\t{options.map((option) => option && DashElementView(option))}\n\t\t</div>\n\t}\n}","import m, {Vnode} from \"mithril\"\nexport function DashRow(... content: Array<Vnode<any, any> | undefined | false>): Vnode<any, any> {\n\treturn (\n\t\t<div class=\"dashRow\">{content}</div>\n\t)\n}","import m, {Vnode} from \"mithril\"\nimport {Lang} from \"../singletons/Lang\";\nimport androidSvg from \"../../imgs/devices/android.svg?raw\"\nimport iosSvg from \"../../imgs/devices/ios.svg?raw\"\nimport webSvg from \"../../imgs/devices/web.svg?raw\"\nimport {closeDropdown, openDropdown} from \"./DropdownMenu\";\n\n\nexport type PossibleDevices = \"Android\" | \"iOS\" | \"Web\"\n\nconst imageRecord: Record<PossibleDevices, string> = {\n\tAndroid: androidSvg,\n\tiOS: iosSvg,\n\tWeb: webSvg\n}\n\nfunction onPointerEnter(title: string, e: MouseEvent) {\n\topenDropdown(\"notCompatible\", e.target as HTMLElement,\n\t\t() => <div class=\"smallText center\">{title}</div>\n\t)\n}\nfunction onPointerLeave() {\n\tcloseDropdown(\"notCompatible\")\n}\n\nexport function NotCompatibleIcon(... devices: PossibleDevices[]): Vnode<any, any> {\n\tconst translationRecord: Record<PossibleDevices, string> = {\n\t\tAndroid: Lang.get(\"Android\"),\n\t\tiOS: Lang.get(\"iOS\"),\n\t\tWeb: Lang.get(\"web_questionnaire\")\n\t}\n\tconst title = Lang.get(\"not_compatible_with\", devices.map((device) => translationRecord[device]).join(\", \"))\n\treturn <div class=\"notCompatibleIcon\" onpointerenter={onPointerEnter.bind(null, title)} onpointerleave={onPointerLeave.bind(null)}>\n\t\t{devices.map((device) =>\n\t\t\t<div class=\"deviceIcon\">{m.trust(imageRecord[device])}</div>)}\n\t</div>\n\n}\n","import m, {Vnode} from \"mithril\"\nexport function TitleRow(\n\ttitle: string | Vnode<any, any>\n): Vnode<any, any> {\n\tif(typeof title == \"string\") {\n\t\treturn <div class=\"titleRow\">\n\t\t\t<span class=\"title\">{title}</span>\n\t\t</div>\n\t}\n\telse {\n\t\ttitle.attrs[\"className\"] = `titleRow ${title.attrs[\"className\"] ?? \"\"}`\n\t\treturn title\n\t}\n}"],"names":["load","get","loadRaw","structure","replace","code","lang","JSON","parse","translations","fallbackLang","loadPublications","publicationsArray","publications","years","publication","hasOwnProperty","year","push","sort","a","b","title","entries","section","about","preLoad","_section","AboutESMiraLoader","Lang","getView","this","class","href","target","alt","src","DashRow","DashElement","template","getUrl","repository_link","msg","icon","page_about","map","entry","TitleRow","id","dash","innerLinkTitle","screenshots","innerLinkHref","urls","url","SectionContent","preInit","Promise","resolve","hasAlternatives","getAlternatives","titleExtra","getDynamic","key","defaultValue","setDynamic","newValue","siteData","dynamicValues","setChild","getStaticInt","getStaticString","getStudyOrNull","studies","studyLoader","getStudies","getCount","getFirst","getEntry","getStudyOrThrow","study","Error","getQuestionnaireOrNull","qId","questionnaires","questionnaire","internalId","getQuestionnaireOrThrow","getTools","getAdmin","hasPermission","name","studyId","isLoggedIn","depth","getHash","goTo","window","location","hash","newSection","destroy","DashElementView","options","view","classString","floatingRight","floating","small","highlight","disabled","content","noCompatibilityIcon","DashTemplateView","startsWith","onclick","showAsClickable","attrs","getNewClassString","size","oldClassString","length","option","imageRecord","Android","iOS","Web","onPointerEnter","e","onPointerLeave","NotCompatibleIcon","translationRecord","devices","device","join","onpointerenter","bind","onpointerleave"],"sourceRoot":""}