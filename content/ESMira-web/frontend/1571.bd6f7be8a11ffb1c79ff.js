"use strict";(self.webpackChunkESMira=self.webpackChunkESMira||[]).push([[1571,6022],{5346:(t,e,n)=>{n.d(e,{M:()=>s});var r=n(3379),o=n(9873),i=n.n(o),s=function(){function t(){}return t.getAccessKey=function(t){var e=t.getStudyOrThrow();return t.getDynamic("accessKey",e.accessKeys.get().length?e.accessKeys.get()[0].get():"").get()},t.processView=function(t,e){var n,o,s,a;switch(t.getAttribute("js-action")){case"internalUrl":t.setAttribute("href",e.getUrl(null!==(o=null===(n=t.getAttribute("href"))||void 0===n?void 0:n.substring(1))&&void 0!==o?o:""));break;case"shown":t.classList.remove("hidden");break;case"hidden":t.classList.add("hidden");break;case"clickable":if(t.classList.add("clickable"),t.hasAttribute("click-show")){var c=document.getElementById(null!==(s=t.getAttribute("click-show"))&&void 0!==s?s:"");c&&t.addEventListener("click",(function(){c.classList.contains("hidden")?c.classList.remove("hidden"):c.classList.add("hidden")}))}break;case"qr":var u=null!==(a=e.getStaticInt("id"))&&void 0!==a?a:-1,l=(0,r.bw)(this.getAccessKey(e),u,-1!=u),d=i()(0,"L");d.addData(l),d.make();var p=d.createDataURL(6);t.src=p}},t.process=function(t,e){for(var n=0,r=t.querySelectorAll("*[js-action]");n<r.length;n++){var o=r[n];this.processView(o,e)}},t}()},6022:(t,e,n)=>{n.r(e),n.d(e,{Content:()=>h});var r,o=n(7097),i=n(4862),s=n.n(i),a=n(9700),c=n(8819),u=n(5346),l=(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((r=r.apply(t,e||[])).next())}))},p=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pageTitle="",e.currentPageHtml="",e.currentPageInt=0,e.noCookieSID="",e.isFinished=!1,e}return l(e,t),e.preLoad=function(t){return[t.getStudyPromise()]},e.prototype.preInit=function(t){return this.loadQuestionnaire()},e.prototype.title=function(){return this.pageTitle},e.prototype.titleExtra=function(){return s()("a",{class:"smallText",href:"mailto: "+this.getStudyOrThrow().contactEmail.get()},a.J.get("contactEmail"))},e.prototype.getAttendQuestionnaire=function(){return this.getQuestionnaireOrThrow()},e.prototype.createUrl=function(){var t,e,n=null!==(t=this.getStaticInt("id"))&&void 0!==t?t:-1,r=null!==(e=this.getStaticInt("qId"))&&void 0!==e?e:-1,o=this.getDynamic("accessKey","");return c.Yg.replace("%d1",n.toString()).replace("%d2",r.toString()).replace("%s1",o.get()).replace("%s2",a.J.code).replace("%s3",this.noCookieSID)},e.prototype.loadQuestionnaire=function(t){return void 0===t&&(t="load"),d(this,void 0,void 0,(function(){var e,n;return p(this,(function(r){switch(r.label){case 0:return[4,this.section.loader.loadJson(this.createUrl(),"post",t)];case 1:switch(e=r.sent(),this.noCookieSID=e.sid,this.pageTitle=e.pageTitle,e.dataType){case"questionnaire":if(this.currentPageHtml=e.pageHtml,this.currentPageInt=e.currentPageInt,e.missingInput){if(!(n=document.getElementById("item-".concat(e.missingInput))))return[2];n.scrollIntoView({behavior:"smooth"}),n.style.outline="5px solid red",window.setTimeout((function(){n.style.outline="unset"}),3e3)}break;case"finished":this.isFinished=!0;break;case"forwarded":this.currentPageHtml=e.pageHtml}return s().redraw(),[2]}}))}))},e.prototype.getQuestionnaireView=function(t){return s()(g,{questionnaire:t,currentPageHtml:this.currentPageHtml,currentPageInt:this.currentPageInt,sectionContent:this})},e.prototype.getView=function(){var t=this.getStudyOrThrow(),e=this.getAttendQuestionnaire();return this.isFinished?s()("div",{class:"center spacingTop highlight"},t.webQuestionnaireCompletedInstructions.get()||a.J.get("default_webQuestionnaireCompletedInstructions")):this.getQuestionnaireView(e)},e}(o.R),g=function(){function t(){}return t.prototype.handleInputs=function(t){var e=document.forms.namedItem("sectionContent");if(e){var n=e.elements.namedItem("responses[".concat(t.name.get(),"]"));if(n&&!n.hasAttribute("was-processed")&&(n instanceof Element&&n.setAttribute("was-processed","true"),n instanceof RadioNodeList&&n[0].setAttribute("was-processed","true"),"va_scale"===t.responseType.get())){if(null==n?void 0:n.getAttribute("no-value")){n.classList.add("not-clicked");var r=function(){return n.classList.remove("not-clicked"),!0};n.addEventListener("mousedown",r),n.addEventListener("touchstart",r)}t.showValue.get()&&n.addEventListener("change",(function(){n.previousElementSibling&&(n.previousElementSibling.innerText=n.value)}))}}},t.prototype.oncreate=function(t){this.rootView=t.dom},t.prototype.onupdate=function(t){t.attrs.questionnaire.pages.get()[t.attrs.currentPageInt].inputs.get().forEach(this.handleInputs);for(var e=0,n=t.dom.getElementsByTagName("form");e<n.length;e++){var r=n[e];r.getAttribute("was-processed")||(r.setAttribute("was-processed","1"),r.addEventListener("submit",this.onFormSubmit.bind(this,t.attrs.sectionContent.loadQuestionnaire.bind(t.attrs.sectionContent))))}u.M.process(t.dom,t.attrs.sectionContent)},t.prototype.onFormSubmit=function(t,e){return d(this,void 0,void 0,(function(){var n,r,o=this;return p(this,(function(i){switch(i.label){case 0:return e.preventDefault(),e.stopPropagation(),n=new FormData(e.target),r=e.submitter.name,n.forEach((function(t,e){r+="&".concat(e,"=").concat(t)})),[4,t(r)];case 1:return i.sent(),window.setTimeout((function(){var t;return null===(t=o.rootView)||void 0===t?void 0:t.scrollIntoView({block:"start",behavior:"smooth"})}),300),[2]}}))}))},t.prototype.view=function(t){return s()("div",{class:"questionnaireBox"},s().trust(t.attrs.currentPageHtml))},t}()},1571:(t,e,n)=>{n.r(e),n.d(e,{Content:()=>l});var r,o=n(4862),i=n.n(o),s=n(6022),a=n(8819),c=n(9700),u=(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t){function e(e,n){var r=t.call(this,e)||this;return r.questionnaireIndex=r.getDynamic("questionnaireIndex",0),r.indexObserverId=r.questionnaireIndex.addObserver((function(){r.loadQuestionnaire()})),r.langObserverId=n.currentLangCode.addObserver((function(){r.loadQuestionnaire()})),r}return u(e,t),e.prototype.createUrl=function(){var t,e=null!==(t=this.getStaticInt("id"))&&void 0!==t?t:-1,n=this.getAttendQuestionnaire(),r=this.getDynamic("accessKey","").get();return a.Yg.replace("%d1",e.toString()).replace("%d2",n.internalId.get().toString()).replace("%s1",r).replace("%s2",c.J.code).replace("%s3","demo=1&".concat(this.noCookieSID))},e.prototype.getAttendQuestionnaire=function(){if("static"==this.section.sectionValue)return this.getQuestionnaireOrThrow();var t=this.getStudyOrThrow(),e=this.questionnaireIndex.get();return t.questionnaires.get()[e]},e.prototype.getView=function(){var t=this.getAttendQuestionnaire();return i()("div",null,t.isDifferent()&&i()("div",{class:"highlight center"},c.J.get("questionnaire_outdated")),this.getQuestionnaireView(t))},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.indexObserverId.removeObserver(),this.langObserverId.removeObserver()},e}(s.Content)},7097:(t,e,n)=>{n.d(e,{R:()=>r});var r=function(){function t(t){this.section=t}return t.preLoad=function(t){return[]},t.prototype.preInit=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Promise.resolve()},t.prototype.hasAlternatives=function(){return!1},t.prototype.getAlternatives=function(){return null},t.prototype.titleExtra=function(){return null},t.prototype.getDynamic=function(t,e){return this.section.getDynamic(t,e)},t.prototype.setDynamic=function(t,e){this.section.siteData.dynamicValues.setChild(t,e)},t.prototype.getStaticInt=function(t){return this.section.getStaticInt(t)},t.prototype.getStaticString=function(t){return this.section.getStaticString(t)},t.prototype.getStudyOrNull=function(t){var e,n;void 0===t&&(t=null!==(e=this.getStaticInt("id"))&&void 0!==e?e:-1);var r=this.section.siteData.studyLoader.getStudies();return-1==t?1==r.getCount()&&r.getFirst()||null:null!==(n=r.getEntry(t))&&void 0!==n?n:null},t.prototype.getStudyOrThrow=function(t){var e;void 0===t&&(t=null!==(e=this.getStaticInt("id"))&&void 0!==e?e:-1);var n=this.getStudyOrNull(t);if(!n)throw new Error("Study ".concat(t," does not exist!"));return n},t.prototype.getQuestionnaireOrNull=function(t,e){var n;if(void 0===t&&(t=null!==(n=this.getStaticInt("qId"))&&void 0!==n?n:-1),void 0===e&&(e=this.getStudyOrNull()),!e)return null;for(var r=0,o=this.getStudyOrThrow().questionnaires.get();r<o.length;r++){var i=o[r];if(i.internalId.get()==t)return i}return null},t.prototype.getQuestionnaireOrThrow=function(t){var e;void 0===t&&(t=null!==(e=this.getStaticInt("qId"))&&void 0!==e?e:-1);var n=this.getQuestionnaireOrNull(t,this.getStudyOrThrow());if(n)return n;throw new Error("Questionnaire ".concat(t," does not exist!"))},t.prototype.getTools=function(){return this.section.getTools()},t.prototype.getAdmin=function(){return this.section.getAdmin()},t.prototype.hasPermission=function(t,e){var n;return this.getAdmin().isLoggedIn()&&null!==(n=this.getTools().hasPermission(t,e))&&void 0!==n&&n},t.prototype.getUrl=function(t,e){return void 0===e&&(e=this.section.depth),"".concat(this.section.getHash(e),"/").concat(t)},t.prototype.goTo=function(t){window.location.hash="#"+t},t.prototype.newSection=function(t,e){void 0===e&&(e=this.section.depth),window.location.hash=-1==e?t:"".concat(this.section.getHash(e),"/").concat(t)},t.prototype.destroy=function(){},t}()}}]);
//# sourceMappingURL=1571.bd6f7be8a11ffb1c79ff.js.map