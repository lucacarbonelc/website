{"version":3,"file":"4769.2be93f203a5c4e98dad5.js","mappings":"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","sources":["webpack://ESMira/./src/frontend/ts/observable/ObservablePromise.ts","webpack://ESMira/./src/frontend/ts/pages/serverStatistics.tsx","webpack://ESMira/./src/frontend/ts/pages/serverStatisticsAdmin.tsx","webpack://ESMira/./src/frontend/ts/site/SectionContent.tsx","webpack://ESMira/./src/frontend/ts/widgets/BtnWidgets.tsx","webpack://ESMira/./src/frontend/ts/widgets/ChartView.tsx","webpack://ESMira/./src/frontend/ts/widgets/DashElement.tsx","webpack://ESMira/./src/frontend/ts/widgets/DashRow.tsx","webpack://ESMira/./src/frontend/ts/widgets/DragContainer.tsx","webpack://ESMira/./src/frontend/ts/widgets/NotCompatibleIcon.tsx","webpack://ESMira/./src/frontend/ts/widgets/TabBar.tsx"],"sourcesContent":["import {ObservableTypes} from \"./types/ObservableTypes\";\nimport {BaseObservable} from \"./BaseObservable\";\nimport { JsonTypes } from \"./types/JsonTypes\";\n\n/**\n * A observable Wrapper that can hold a Promise\n */\nexport class ObservablePromise<T> extends BaseObservable<Promise<T>> {\n\tprotected backingField: Promise<T>\n\t\n\tconstructor(value: Promise<T>, parent: BaseObservable<ObservableTypes> | null, key: string) {\n\t\tsuper(parent, key)\n\t\tthis.keyName = key\n\t\tthis.backingField = value\n\t}\n\t\n\tpublic reCalcIsDifferent(_: boolean = false): void {\n\t\t//do nothing\n\t}\n\t\n\tpublic createJson(): JsonTypes {\n        return \"\"\n    }\n\t\n\tpublic isDifferent(): boolean {\n\t\treturn false\n\t}\n\t\n\tpublic get(): Promise<any> {\n\t\treturn this.backingField\n\t}\n\tpublic set(value: Promise<T>, silently: boolean = false): void {\n\t\tthis.backingField = value\n\t\tif(!silently)\n\t\t\tthis.hasMutated(true, true)\n\t}\n\tpublic setValue(value: T, silently: boolean = false) {\n\t\tthis.set(Promise.resolve(value), silently)\n\t}\n}","import {SectionContent} from \"../site/SectionContent\";\nimport m, {Vnode} from \"mithril\";\nimport {Lang} from \"../singletons/Lang\";\nimport {Section} from \"../site/Section\";\nimport {DashRow} from \"../widgets/DashRow\";\nimport {DashElement} from \"../widgets/DashElement\";\nimport {Requests} from \"../singletons/Requests\";\nimport {FILE_SERVER_STATISTICS} from \"../constants/urls\";\nimport {ChartView} from \"../widgets/ChartView\";\nimport {ChartData} from \"../data/study/ChartData\";\nimport {ObservablePromise} from \"../observable/ObservablePromise\";\nimport {LoadedStatistics} from \"../loader/csv/CsvLoaderCollectionFromCharts\";\nimport {\n\tSTATISTICS_CHARTTYPES_BARS,\n\tSTATISTICS_CHARTTYPES_LINE, STATISTICS_CHARTTYPES_LINE_FILLED,\n\tSTATISTICS_CHARTTYPES_PIE,\n\tSTATISTICS_DATATYPES_DAILY,\n\tSTATISTICS_DATATYPES_FREQ_DISTR, STATISTICS_STORAGE_TYPE_FREQ_DISTR, STATISTICS_STORAGE_TYPE_TIMED,\n\tSTATISTICS_VALUETYPES_COUNT, STATISTICS_VALUETYPES_SUM\n} from \"../constants/statistics\";\nimport {JsonTypes} from \"../observable/types/JsonTypes\";\nimport {StatisticsEntry} from \"../data/statistics/StatisticsEntry\";\nimport { StatisticsEntryTimed} from \"../data/statistics/StatisticsDataRecord\";\nimport {DayEntry} from \"../data/serverStatistics/DayEntry\";\nimport {WeekEntry} from \"../data/serverStatistics/WeekEntry\";\nimport {ServerStatistics} from \"../data/serverStatistics/ServerStatistics\";\nimport {BtnReload} from \"../widgets/BtnWidgets\";\n\nconst SMALLEST_TIMED_DISTANCE = 675\nexport class Content extends SectionContent {\n\tprivate readonly serverStatistics: ServerStatistics\n\t\n\tprivate readonly appTypeChart: ChartData\n\tprotected dailyAppVersionChart?: ChartData //only written by serverStatisticsAdmin\n\tprivate readonly dailyQuestionnaireChart: ChartData\n\tprivate readonly dailyJoinedChart: ChartData\n\tprivate readonly weekdaysQuestionnaireChart: ChartData\n\tprivate readonly weekdaysJoinedChart: ChartData\n\t\n\tprivate readonly appTypePromise: ObservablePromise<LoadedStatistics>\n\tprotected dailyAppVersionPromise?: ObservablePromise<LoadedStatistics> //only written by serverStatisticsAdmin\n\tprivate readonly dailyQuestionnairePromise: ObservablePromise<LoadedStatistics>\n\tprivate readonly dailyJoinedPromise: ObservablePromise<LoadedStatistics>\n\tprivate readonly weekdaysQuestionnairePromise: ObservablePromise<LoadedStatistics>\n\tprivate readonly weekdaysJoinedPromise: ObservablePromise<LoadedStatistics>\n\t\n\tpublic static preLoad(_section: Section): Promise<any>[] {\n\t\treturn [\n\t\t\tRequests.loadJson(FILE_SERVER_STATISTICS)\n\t\t]\n\t}\n\tconstructor(section: Section, serverStatistics: ServerStatistics) {\n\t\tsuper(section)\n\t\tthis.serverStatistics = serverStatistics\n\t\t\n\t\tthis.appTypeChart = this.createAppTypeChart()\n\t\tthis.dailyQuestionnaireChart = this.createDailyQuestionnaireChart()\n\t\tthis.dailyJoinedChart = this.createDailyJoinedChart()\n\t\tthis.weekdaysQuestionnaireChart = this.createWeekdaysQuestionnaireChart()\n\t\tthis.weekdaysJoinedChart = this.createWeekdaysJoinedChart()\n\t\t\n\t\tthis.appTypePromise = this.createChartPromise(\"appType\", [{\n\t\t\tstorageType: STATISTICS_STORAGE_TYPE_FREQ_DISTR,\n\t\t\tdata: {\n\t\t\t\t[Lang.get(\"Android\")]: serverStatistics.total.android,\n\t\t\t\t[Lang.get(\"iOS\")]: serverStatistics.total.ios,\n\t\t\t\t[Lang.get(\"Web\")]: serverStatistics.total.web\n\t\t\t},\n\t\t\tentryCount: 3,\n\t\t\ttimeInterval: SMALLEST_TIMED_DISTANCE\n\t\t}])\n\t\tthis.dailyQuestionnairePromise = this.createChartPromise(\"questionnaire\", [this.createDailyStatisticsEntry(serverStatistics, \"questionnaire\")])\n\t\tthis.dailyJoinedPromise = this.createChartPromise(\"joined\", [this.createDailyStatisticsEntry(serverStatistics, \"joined\")])\n\t\tthis.weekdaysQuestionnairePromise = this.createChartPromise(\"weekdaysQuestionnaire\", [this.createWeeklyStatisticsEntry(serverStatistics, \"questionnaire\")])\n\t\tthis.weekdaysJoinedPromise = this.createChartPromise(\"weekdaysJoin\", [this.createWeeklyStatisticsEntry(serverStatistics, \"joined\")])\n\t}\n\t\n\t\n\tpublic titleExtra(): Vnode<any, any> | null {\n\t\treturn BtnReload(this.section.reload.bind(this.section), Lang.get(\"reload\"))\n\t}\n\t\n\tprotected createChartPromise(variable: string, entries: StatisticsEntry[]): ObservablePromise<LoadedStatistics> {\n\t\treturn new ObservablePromise<LoadedStatistics>(\n\t\t\tPromise.resolve({\n\t\t\t\tmainStatistics: {[variable]: entries}\n\t\t\t}),\n\t\t\tnull,\n\t\t\t\"promise\"\n\t\t)\n\t}\n\t\n\tprivate createWeeklyStatisticsEntry(serverStatistics: ServerStatistics, type: keyof WeekEntry): StatisticsEntry {\n\t\treturn {\n\t\t\tstorageType: STATISTICS_STORAGE_TYPE_FREQ_DISTR,\n\t\t\ttimeInterval: SMALLEST_TIMED_DISTANCE,\n\t\t\tentryCount: 7,\n\t\t\tdata: {\n\t\t\t\t[Lang.get(\"weekday_mon\")]: serverStatistics.week[type][1],\n\t\t\t\t[Lang.get(\"weekday_tue\")]: serverStatistics.week[type][2],\n\t\t\t\t[Lang.get(\"weekday_wed\")]: serverStatistics.week[type][3],\n\t\t\t\t[Lang.get(\"weekday_thu\")]: serverStatistics.week[type][4],\n\t\t\t\t[Lang.get(\"weekday_fri\")]: serverStatistics.week[type][5],\n\t\t\t\t[Lang.get(\"weekday_sat\")]: serverStatistics.week[type][6],\n\t\t\t\t[Lang.get(\"weekday_sun\")]: serverStatistics.week[type][0]\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprotected createDailyStatisticsEntry(serverStatistics: ServerStatistics, variable: keyof DayEntry, subVariable: string = \"\"): StatisticsEntry {\n\t\tconst statisticsData: StatisticsEntryTimed = {}\n\t\tlet count = 0\n\t\tconst days = serverStatistics.days\n\t\t\n\t\tfor(const timestamp in days) {\n\t\t\tconst entry = days[timestamp]\n\t\t\tif(entry.hasOwnProperty(variable)) {\n\t\t\t\tif(variable == \"appVersion\")\n\t\t\t\t\tstatisticsData[timestamp] = {sum: entry[variable].hasOwnProperty(subVariable) ? entry[variable][subVariable] : 0, count: 1}\n\t\t\t\telse\n\t\t\t\t\tstatisticsData[timestamp] = {sum: entry[variable], count: 1}\n\t\t\t}\n\t\t\telse\n\t\t\t\tstatisticsData[timestamp] = {sum: 0, count: 1}\n\t\t\t++count\n\t\t}\n\t\t\n\t\treturn {\n\t\t\tstorageType: STATISTICS_STORAGE_TYPE_TIMED,\n\t\t\ttimeInterval: SMALLEST_TIMED_DISTANCE,\n\t\t\tentryCount: count,\n\t\t\tdata: statisticsData\n\t\t}\n\t}\n\t\n\tprivate createAppTypeChart(): ChartData {\n\t\treturn new ChartData({\n\t\t\ttitle: Lang.get(\"app_type\"),\n\t\t\tpublicVariables: [],\n\t\t\taxisContainer: [\n\t\t\t\t{\n\t\t\t\t\txAxis: {\n\t\t\t\t\t\tconditions: []\n\t\t\t\t\t},\n\t\t\t\t\tyAxis: {\n\t\t\t\t\t\tconditions: [],\n\t\t\t\t\t\tvariableName: \"appType\",\n\t\t\t\t\t\tobservedVariableIndex: 0\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t],\n\t\t\tvalueType: STATISTICS_VALUETYPES_COUNT,\n\t\t\tdataType: STATISTICS_DATATYPES_FREQ_DISTR,\n\t\t\tchartType: STATISTICS_CHARTTYPES_PIE\n\t\t}, null, \"chart\")\n\t}\n\tprotected createDailyAppVersionChart(appVersionAxisContainer: Record<string, JsonTypes>[]): ChartData {\n\t\treturn new ChartData({\n\t\t\ttitle: Lang.get(\"app_version\"),\n\t\t\tpublicVariables: [],\n\t\t\taxisContainer: appVersionAxisContainer,\n\t\t\tvalueType: STATISTICS_VALUETYPES_SUM,\n\t\t\tdataType: STATISTICS_DATATYPES_DAILY,\n\t\t\tchartType: STATISTICS_CHARTTYPES_LINE\n\t\t}, null, \"chart\")\n\t}\n\tprivate createDailyQuestionnaireChart(): ChartData {\n\t\treturn new ChartData({\n\t\t\ttitle: Lang.get(\"per_day\"),\n\t\t\tpublicVariables: [],\n\t\t\taxisContainer: [\n\t\t\t\t{\n\t\t\t\t\txAxis: {\n\t\t\t\t\t\tconditions: []\n\t\t\t\t\t},\n\t\t\t\t\tyAxis: {\n\t\t\t\t\t\tconditions: [],\n\t\t\t\t\t\tvariableName: \"questionnaire\",\n\t\t\t\t\t\tobservedVariableIndex: 0\n\t\t\t\t\t},\n\t\t\t\t\tlabel: Lang.get(\"questionnaires\"),\n\t\t\t\t\tcolor: \"#00ffff\"\n\t\t\t\t}\n\t\t\t],\n\t\t\tvalueType: STATISTICS_VALUETYPES_SUM,\n\t\t\tdataType: STATISTICS_DATATYPES_DAILY,\n\t\t\tchartType: STATISTICS_CHARTTYPES_LINE_FILLED\n\t\t}, null, \"chart\")\n\t}\n\tprivate createDailyJoinedChart(): ChartData {\n\t\treturn new ChartData({\n\t\t\ttitle: Lang.get(\"per_day\"),\n\t\t\tpublicVariables: [],\n\t\t\taxisContainer: [\n\t\t\t\t{\n\t\t\t\t\txAxis: {\n\t\t\t\t\t\tconditions: []\n\t\t\t\t\t},\n\t\t\t\t\tyAxis: {\n\t\t\t\t\t\tconditions: [],\n\t\t\t\t\t\tvariableName: \"joined\",\n\t\t\t\t\t\tobservedVariableIndex: 0\n\t\t\t\t\t},\n\t\t\t\t\tlabel: Lang.get(\"joined_study\"),\n\t\t\t\t\tcolor: \"#80ff80\"\n\t\t\t\t}\n\t\t\t],\n\t\t\tvalueType: STATISTICS_VALUETYPES_SUM,\n\t\t\tdataType: STATISTICS_DATATYPES_DAILY,\n\t\t\tchartType: STATISTICS_CHARTTYPES_LINE_FILLED\n\t\t}, null, \"chart\")\n\t}\n\tprivate createWeekdaysQuestionnaireChart(): ChartData {\n\t\treturn new ChartData({\n\t\t\ttitle: Lang.get(\"total_count_per_weekday\"),\n\t\t\tpublicVariables: [],\n\t\t\taxisContainer: [\n\t\t\t\t{\n\t\t\t\t\txAxis: {\n\t\t\t\t\t\tconditions: []\n\t\t\t\t\t},\n\t\t\t\t\tyAxis: {\n\t\t\t\t\t\tconditions: [],\n\t\t\t\t\t\tvariableName: \"weekdaysQuestionnaire\",\n\t\t\t\t\t\tobservedVariableIndex: 0\n\t\t\t\t\t},\n\t\t\t\t\tlabel: Lang.get(\"questionnaires\"),\n\t\t\t\t\tcolor: \"#00ffff\"\n\t\t\t\t},\n\t\t\t],\n\t\t\tvalueType: STATISTICS_VALUETYPES_SUM,\n\t\t\tdataType: STATISTICS_DATATYPES_FREQ_DISTR,\n\t\t\tchartType: STATISTICS_CHARTTYPES_BARS\n\t\t}, null, \"chart\")\n\t}\n\tprivate createWeekdaysJoinedChart(): ChartData {\n\t\treturn new ChartData({\n\t\t\ttitle: Lang.get(\"total_count_per_weekday\"),\n\t\t\tpublicVariables: [],\n\t\t\taxisContainer: [\n\t\t\t\t{\n\t\t\t\t\txAxis: {\n\t\t\t\t\t\tconditions: []\n\t\t\t\t\t},\n\t\t\t\t\tyAxis: {\n\t\t\t\t\t\tconditions: [],\n\t\t\t\t\t\tvariableName: \"weekdaysJoin\",\n\t\t\t\t\t\tobservedVariableIndex: 0\n\t\t\t\t\t},\n\t\t\t\t\tlabel: Lang.get(\"joined_study\"),\n\t\t\t\t\tcolor: \"#80ff80\"\n\t\t\t\t}\n\t\t\t],\n\t\t\tvalueType: STATISTICS_VALUETYPES_SUM,\n\t\t\tdataType: STATISTICS_DATATYPES_FREQ_DISTR,\n\t\t\tchartType: STATISTICS_CHARTTYPES_BARS\n\t\t}, null, \"chart\")\n\t}\n\t\n\tpublic title(): string {\n\t\treturn Lang.get(\"server_statistics\")\n\t}\n\t\n\tpublic getView(): Vnode<any, any> {\n\t\treturn <div>\n\t\t\t{DashRow(\n\t\t\t\tDashElement(\"vertical\",\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent:\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<h2 class=\"center\">{Lang.getWithColon(\"active_studies\")}</h2>\n\t\t\t\t\t\t\t\t<div class=\"center\">{this.serverStatistics.total.studies}</div>\n\t\t\t\t\t\t\t\t<br/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent:\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<h2 class=\"center\">{Lang.getWithColon(\"total_completed_questionnaires\")}</h2>\n\t\t\t\t\t\t\t\t<div class=\"center\">{this.serverStatistics.total.questionnaire}</div>\n\t\t\t\t\t\t\t\t<br/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent:\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<h2 class=\"center\">{Lang.getWithColon(\"total_participants\")}</h2>\n\t\t\t\t\t\t\t\t<div class=\"center\">{this.serverStatistics.total.users}</div>\n\t\t\t\t\t\t\t\t<br/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t\t),\n\t\t\t\tDashElement(null, {\n\t\t\t\t\tcontent: ChartView(this.appTypeChart, this.appTypePromise)\n\t\t\t\t}),\n\t\t\t\tthis.dailyAppVersionPromise && this.dailyAppVersionChart && DashElement(\"stretched\", {\n\t\t\t\t\tcontent: ChartView(this.dailyAppVersionChart, this.dailyAppVersionPromise)\n\t\t\t\t}),\n\t\t\t\tDashElement(\"stretched\", {\n\t\t\t\t\tcontent: ChartView(this.dailyQuestionnaireChart, this.dailyQuestionnairePromise)\n\t\t\t\t}),\n\t\t\t\tDashElement(\"stretched\", {\n\t\t\t\t\tcontent: ChartView(this.dailyJoinedChart, this.dailyJoinedPromise)\n\t\t\t\t}),\n\t\t\t\tDashElement(null, {\n\t\t\t\t\tcontent: ChartView(this.weekdaysQuestionnaireChart, this.weekdaysQuestionnairePromise, true)\n\t\t\t\t}),\n\t\t\t\tDashElement(null, {\n\t\t\t\t\tcontent: ChartView(this.weekdaysJoinedChart, this.weekdaysJoinedPromise, true)\n\t\t\t\t})\n\t\t\t)}\n\t\t\t\n\t\t\t<br/>\n\t\t\t<br/>\n\t\t\t<div class=\"smallText right\">\n\t\t\t\t<span>{Lang.getWithColon(\"data_collected_since\")}</span>\n\t\t\t\t&nbsp;\n\t\t\t\t<span>{(new Date(this.serverStatistics.created*1000).toLocaleDateString())}</span>\n\t\t\t</div>\n\t\t</div>\n\t}\n}","import m, {Vnode} from \"mithril\";\nimport {Lang} from \"../singletons/Lang\";\nimport {Section} from \"../site/Section\";\nimport {Requests} from \"../singletons/Requests\";\nimport {FILE_ADMIN, FILE_SERVER_STATISTICS} from \"../constants/urls\";\nimport {getChartColor} from \"../helpers/ChartJsBox\";\nimport {JsonTypes} from \"../observable/types/JsonTypes\";\nimport {StatisticsEntry} from \"../data/statistics/StatisticsEntry\";\nimport {ServerStatistics} from \"../data/serverStatistics/ServerStatistics\";\nimport {Content as ServerStatisticsContent} from \"../pages/serverStatistics\";\nimport {TabBar} from \"../widgets/TabBar\";\nimport {ObservablePrimitive} from \"../observable/ObservablePrimitive\";\n\nconst SECONDS_14_DAYS = 60*60*24*14\n\nexport class Content extends ServerStatisticsContent {\n\tprivate tabIndex = new ObservablePrimitive(0, null, \"serverStatistics\")\n\t\n\tprivate readonly lastActivitiesList: { id: number, timestamp: number }[]\n\tprivate readonly usedSpaceList: { id: number, fileSize: number }[]\n\tprivate readonly totalUsedSpace: number\n\t\n\t\n\tpublic static preLoad(section: Section): Promise<any>[] {\n\t\treturn [\n\t\t\tRequests.loadJson(FILE_SERVER_STATISTICS),\n\t\t\tRequests.loadJson(`${FILE_ADMIN}?type=GetLastActivities`),\n\t\t\tRequests.loadJson(`${FILE_ADMIN}?type=GetUsedSpacePerStudy`),\n\t\t\tsection.getStrippedStudyListPromise()\n\t\t]\n\t}\n\tconstructor(section: Section, serverStatistics: ServerStatistics, lastActivities: Record<number, number>, usedSpace: Record<number, number>) {\n\t\tsuper(section, serverStatistics)\n\t\t\n\t\t//lastActivities:\n\t\tconst lastActivitiesList: { id: number, timestamp: number }[] = []\n\t\tfor(const studyId in lastActivities) {\n\t\t\tlastActivitiesList.push({id: parseInt(studyId), timestamp: lastActivities[studyId]})\n\t\t}\n\t\tlastActivitiesList.sort(function(a, b) {\n\t\t\treturn b.timestamp - a.timestamp\n\t\t})\n\t\tthis.lastActivitiesList = lastActivitiesList\n\t\t\n\t\t\n\t\t//usedSpace:\n\t\tconst usedSpaceList: { id: number, fileSize: number }[] = []\n\t\tlet totalUsedSpace = 0\n\t\tfor(const studyId in usedSpace) {\n\t\t\tconst fileSize = usedSpace[studyId]\n\t\t\ttotalUsedSpace += fileSize\n\t\t\tusedSpaceList.push({id: parseInt(studyId), fileSize: fileSize})\n\t\t}\n\t\tusedSpaceList.sort(function(a, b) {\n\t\t\treturn b.fileSize - a.fileSize\n\t\t})\n\t\tthis.usedSpaceList = usedSpaceList\n\t\tthis.totalUsedSpace = totalUsedSpace\n\t\t\n\t\tthis.setAppVersionChartAndPromise(serverStatistics)\n\t}\n\t\n\tprivate setAppVersionChartAndPromise(serverStatistics: ServerStatistics): void {\n\t\tconst appVersionLabels: Record<string, boolean> = {}\n\t\tconst days = serverStatistics.days\n\t\tfor(const timestamp in days) {\n\t\t\tconst appVersion = days[timestamp].appVersion\n\t\t\tif(appVersion) {\n\t\t\t\tfor(const key in appVersion) {\n\t\t\t\t\tif(!appVersionLabels.hasOwnProperty(key))\n\t\t\t\t\t\tappVersionLabels[key] = true\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconst keys = Object.keys(appVersionLabels).sort()\n\t\t\n\t\tconst appVersionAxisContainer: Record<string, JsonTypes>[] = []\n\t\tconst appVersionStatistics: StatisticsEntry[] = []\n\t\tlet i = 0\n\t\tfor(const key of keys) {\n\t\t\tif(key.indexOf(\"_dev\") != -1 || key.indexOf(\"wasDev\") != -1)\n\t\t\t\tcontinue\n\t\t\tappVersionStatistics.push(this.createDailyStatisticsEntry(serverStatistics, \"appVersion\", key))\n\t\t\t\n\t\t\tappVersionAxisContainer.push({\n\t\t\t\txAxis: {\n\t\t\t\t\tconditions: []\n\t\t\t\t},\n\t\t\t\tyAxis: {\n\t\t\t\t\tconditions: [],\n\t\t\t\t\tvariableName: \"appVersion\",\n\t\t\t\t\tobservedVariableIndex: i\n\t\t\t\t},\n\t\t\t\tlabel: key,\n\t\t\t\tcolor: getChartColor(i)\n\t\t\t})\n\t\t\t++i\n\t\t}\n\t\t\n\t\tthis.dailyAppVersionChart = this.createDailyAppVersionChart(appVersionAxisContainer)\n\t\tthis.dailyAppVersionPromise = this.createChartPromise(\"appVersion\", appVersionStatistics)\n\t}\n\t\n\tprivate getReadableByteSize(bytes: number): string {\n\t\tif(bytes > 1000000000)\n\t\t\treturn `${Math.round(bytes / 10000000) / 100} Gb`\n\t\telse if(bytes > 1000000)\n\t\t\treturn `${Math.round(bytes / 10000) / 100} Mb`\n\t\telse\n\t\t\treturn `${Math.round(bytes / 1000)} Kb`\n\t}\n\t\n\tpublic getView(): Vnode<any, any> {\n\t\tconst studies = this.section.siteData.studyLoader.getStudies()\n\t\treturn TabBar(this.tabIndex, [\n\t\t\t{\n\t\t\t\ttitle: Lang.get(\"server_statistics\"),\n\t\t\t\tview: () => super.getView()\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: Lang.get(\"last_activities\"),\n\t\t\t\tview: () => <table style=\"width: 100%\">\n\t\t\t\t\t{this.lastActivitiesList.map((entry) => {\n\t\t\t\t\t\t\tconst study = studies.getEntry(entry.id)\n\t\t\t\t\t\t\treturn <tr>\n\t\t\t\t\t\t\t\t<td class={study?.published.get() ? \"\" : \"unPublishedStudy\"}>\n\t\t\t\t\t\t\t\t\t<a href={this.getUrl(`dataStatistics,id:${entry.id}`)}>{study?.title.get()}</a>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td class={Date.now()/1000 - entry.timestamp < SECONDS_14_DAYS ? \"highlight\" : \"\"}>{new Date(entry.timestamp*1000).toLocaleString()}</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t}\n\t\t\t\t\t)}\n\t\t\t\t</table>\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: Lang.get(\"disk_space\"),\n\t\t\t\tview: () => {\n\t\t\t\t\tconst tools = this.section.getTools()\n\t\t\t\t\treturn <table style=\"width: 100%\">\n\t\t\t\t\t\t<tr class=\"highlight\">\n\t\t\t\t\t\t\t<td>{Lang.getWithColon(\"disk_space\")}</td>\n\t\t\t\t\t\t\t<td>{this.getReadableByteSize(tools.totalDiskSpace - tools.freeDiskSpace)} / {this.getReadableByteSize(tools.totalDiskSpace)}</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr class=\"highlight\">\n\t\t\t\t\t\t\t<td>{Lang.getWithColon(\"studies\")}</td>\n\t\t\t\t\t\t\t<td>{this.getReadableByteSize(this.totalUsedSpace)}</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr><td colspan=\"2\"><hr/></td></tr>\n\t\t\t\t\t\t{this.usedSpaceList.map((entry) => {\n\t\t\t\t\t\t\tconst study = studies.getEntry(entry.id)\n\t\t\t\t\t\t\treturn <tr>\n\t\t\t\t\t\t\t\t<td class={study?.published.get() ? \"\" : \"unPublishedStudy\"}>\n\t\t\t\t\t\t\t\t\t<a href={this.getUrl(`dataStatistics,id:${entry.id}`)}>{Lang.get(\"colon\", study?.title.get() ?? \"Error\")}</a>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td class={entry.fileSize > 100000000 ? \"highlight\" : \"\"}>{this.getReadableByteSize(entry.fileSize)}</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t})}\n\t\t\t\t\t</table>\n\t\t\t\t}\n\t\t\t},\n\t\t])\n\t}\n}","import m, {Vnode} from \"mithril\";\nimport {Section} from \"./Section\";\nimport {Study} from \"../data/study/Study\";\nimport {StaticValues} from \"./StaticValues\";\nimport {ObservablePrimitive} from \"../observable/ObservablePrimitive\";\nimport {Questionnaire} from \"../data/study/Questionnaire\";\nimport {DynamicValues} from \"./DynamicValues\";\nimport {PrimitiveType} from \"../observable/types/PrimitiveType\";\nimport {AccountPermissions} from \"../admin/AccountPermissions\";\nimport {AdminToolsInterface} from \"../admin/AdminToolsInterface\";\nimport {Admin} from \"../admin/Admin\";\n\nexport interface SectionAlternative {\n\ttitle: string\n\ttarget: string | false\n\theader?: boolean\n}\n\n/**\n * The dynamic content class of each section. Each section extends this class. SectionContent is a child of {@link Section} which takes care of loading and\n * displaying SectionContent.\n * Important: Changes to Observables in data.dataTypes will lead to {@link m.redraw()} (see {@link StudyLoader.constructor()}).\n * BUT, changes to the dom will happen asynchronously. In other words: The philosophy is, that {@link getView()} always works with fresh (not cached) data\n * and always constructs the full section (instead of just updating it). Mithril will take care of keeping track of changes and updates the dom when necessary.\n *\n * Method calls are guaranteed to be in this order:\n * 1. {@link preLoad()}\n * 2. {@link preInit()}\n * 3. {@link title()}, {@link titleExtra()}, {@link getView()}\n * Have a look at the implementation in {@link Section.load()} for more information\n */\nexport abstract class SectionContent {\n\tpublic readonly section: Section\n\t\n\tconstructor(section: Section) {\n\t\tthis.section = section\n\t}\n\t\n\t/**\n\t * Is always called before anything else.\n\t * @returns Promise array. The section will be in loading state and not other methods will be called as long as these Promises are loading\n\t */\n\tpublic static preLoad(_section: Section): Promise<any>[] {\n\t\treturn []\n\t}\n\t\n\t/**\n\t * Is guaranteed to run AFTER all promises in {@link preLoad()} are finished\n\t * @param _responses Holds the return values of each Promise from {@link preLoad()}\n\t */\n\tpublic preInit(... _responses: any): Promise<any> {\n\t\treturn Promise.resolve()\n\t}\n\tpublic hasAlternatives(): boolean {\n\t\treturn false\n\t}\n\tpublic getAlternatives(): SectionAlternative[] | Promise<SectionAlternative[]> | null {\n\t\treturn null\n\t}\n\t\n\tpublic abstract title(): string\n\t\n\tpublic titleExtra(): Vnode<any, any> | null {\n\t\treturn null\n\t}\n\t\n\t\n\tpublic getDynamic<T extends PrimitiveType>(key: keyof DynamicValues, defaultValue: T): ObservablePrimitive<T> {\n\t\treturn this.section.getDynamic(key, defaultValue)\n\t}\n\tpublic setDynamic<T extends PrimitiveType>(key: keyof DynamicValues, newValue: T) {\n\t\tthis.section.siteData.dynamicValues.setChild(key, newValue)\n\t}\n\tpublic getStaticInt<T extends StaticValues>(key: T): number | null {\n\t\treturn this.section.getStaticInt(key)\n\t}\n\tpublic getStaticString<T extends StaticValues>(key: T): string | null {\n\t\treturn this.section.getStaticString(key)\n\t}\n\tprotected getStudyOrNull(id: number = this.getStaticInt(\"id\") ?? -1): Study | null {\n\t\tconst studies = this.section.siteData.studyLoader.getStudies()\n\t\tif(id == -1)\n\t\t\treturn studies.getCount() == 1 ? (studies.getFirst() || null) : null\n\t\t\n\t\treturn studies.getEntry(id) ?? null\n\t}\n\tpublic getStudyOrThrow(id: number = this.getStaticInt(\"id\") ?? -1): Study {\n\t\tconst study = this.getStudyOrNull(id)\n\t\tif(!study)\n\t\t\tthrow new Error(`Study ${id} does not exist!`)\n\t\treturn study\n\t}\n\tprotected getQuestionnaireOrNull(qId: number = this.getStaticInt(\"qId\") ?? -1, study: Study | null = this.getStudyOrNull()): Questionnaire | null {\n\t\tif(!study)\n\t\t\treturn null\n\t\tconst questionnaires = this.getStudyOrThrow().questionnaires.get()\n\t\tfor(const questionnaire of questionnaires) {\n\t\t\tif(questionnaire.internalId.get() == qId)\n\t\t\t\treturn questionnaire\n\t\t}\n\t\treturn null\n\t}\n\tprotected getQuestionnaireOrThrow(qId: number = this.getStaticInt(\"qId\") ?? -1): Questionnaire {\n\t\tconst questionnaire = this.getQuestionnaireOrNull(qId, this.getStudyOrThrow())\n\t\tif(!questionnaire)\n\t\t\tthrow new Error(`Questionnaire ${qId} does not exist!`)\n\t\telse\n\t\t\treturn questionnaire\n\t}\n\t\n\tpublic getTools(): AdminToolsInterface {\n\t\treturn this.section.getTools()\n\t}\n\tpublic getAdmin(): Admin {\n\t\treturn this.section.getAdmin()\n\t}\n\t\n\tpublic hasPermission(name: keyof AccountPermissions, studyId: number): boolean {\n\t\treturn this.getAdmin().isLoggedIn() && (this.getTools().hasPermission(name, studyId) ?? false)\n\t}\n\t\n\tpublic getUrl(name: string, depth: number = this.section.depth): string {\n\t\treturn `${this.section.getHash(depth)}/${name}`\n\t}\n\tpublic goTo(target: string): void {\n\t\twindow.location.hash = \"#\"+target;\n\t}\n\tpublic newSection(target: string, depth: number = this.section.depth): void {\n\t\twindow.location.hash = depth == -1 ? target : `${this.section.getHash(depth)}/${target}`\n\t}\n\t\n\t\n\t/**\n\t * Remember: Values or references of observables should NOT be cached (also when the value is an observable itself)\n\t * It would lead to new values not being updated properly on {@link m.redraw()}\n\t *\n\t * Examples:\n\t * You can cache: {@link StudyLoader.studyCache}. Because this observable is readonly and will never be replaced\n\t * You can NOT cache {@link StudyLoader.studyCache.get()} or {@link getStudyOrThrow()} or {@link getStudy().questionnaires.get()[2]}.\n\t * \t\tBecause all study entries in StudyLoader might have been replaced or removed between {@link m.redraw()}\n\t *\n\t * You can cache: {@link SiteData.dynamicValues[\"accessKey\"]} because {@link Container} uses Singletons (see {@link Container.getOrCreateObs()})\n\t * You can not cache: {@link SiteData.dynamicValues[\"accessKey\"].get()} because its value might change\n\t *\n\t * In conclusion: {@link getView()} always needs to work with fresh values. Starting, for example, with {@link getStudyOrThrow()}\n\t */\n\tpublic abstract getView(): Vnode<any, any>\n\t\n\tpublic destroy(): void {\n\t\t//do nothing\n\t}\n}","import m, {Vnode} from \"mithril\"\nimport {Lang} from \"../singletons/Lang\";\nimport addSvg from \"../../imgs/icons/addCircle.svg?raw\";\nimport changeSvg from \"../../imgs/icons/change.svg?raw\";\nimport copySvg from \"../../imgs/icons/copy.svg?raw\";\nimport editSvg from \"../../imgs/icons/edit.svg?raw\";\nimport okSvg from \"../../imgs/icons/ok.svg?raw\";\nimport reloadSvg from \"../../imgs/icons/reload.svg?raw\";\nimport removeSvg from \"../../imgs/icons/remove.svg?raw\";\nimport transferSvg from \"../../imgs/icons/transfer.svg?raw\";\nimport trashSvg from \"../../imgs/icons/trash.svg?raw\";\n\nexport function BtnCustom(\n\ticon: Vnode<any, any>,\n\tonclick?: (e: MouseEvent) => void,\n\ttitle: string = \"\",\n\thoverTitle: string = \"\"\n): Vnode<any, any> {\n\treturn (\n\t\t<div class=\"btn clickable\" onclick={onclick} title={title || hoverTitle}>\n\t\t\t{icon}\n\t\t\t<span class=\"middle smallText\">{title}</span>\n\t\t</div>\n\t)\n}\nexport function BtnRemove(onclick: () => void, title: string = \"\",): Vnode<any, any> {\n\treturn (\n\t\t<div class=\"btn btnDelete clickable\" onclick={onclick} title={title || Lang.get(\"delete\")}>\n\t\t\t{m.trust(removeSvg)}\n\t\t\t<span class=\"smallText highlight middle\">{title}</span>\n\t\t</div>\n\t)\n}\nexport function BtnTrash(onclick: () => void, title: string = \"\",): Vnode<any, any> {\n\treturn (\n\t\t<div class=\"btn btnDelete clickable\" onclick={onclick} title={title || Lang.get(\"delete\")}>\n\t\t\t{m.trust(trashSvg)}\n\t\t\t<span class=\"highlight middle\">{title}</span>\n\t\t</div>\n\t)\n}\n\n\nexport function BtnAdd(onclick?: (e: MouseEvent) => void, title: string = \"\"): Vnode<any, any> {\n\treturn BtnCustom(m.trust(addSvg), onclick, title, Lang.get(\"add\"))\n}\n\nexport function BtnCopy(onclick?: () => void, title: string = \"\"): Vnode<any, any> {\n\treturn BtnCustom(m.trust(copySvg), onclick, title, Lang.get(\"copy\"))\n}\n\nexport function BtnEdit(onclick?: () => void, title: string = \"\"): Vnode<any, any> {\n\treturn BtnCustom(m.trust(editSvg), onclick, title, Lang.get(\"change\"))\n}\n\nexport function BtnChange(onclick?: () => void, title: string = \"\"): Vnode<any, any> {\n\treturn BtnCustom(m.trust(changeSvg), onclick, title, Lang.get(\"change\"))\n}\n\nexport function BtnOk(onclick?: () => void, title: string = \"\"): Vnode<any, any> {\n\treturn BtnCustom(m.trust(okSvg), onclick, title, Lang.get(\"save\"))\n}\n\nexport function BtnReload(onclick?: () => void, title: string = \"\"): Vnode<any, any> {\n\treturn BtnCustom(m.trust(reloadSvg), onclick, title, Lang.get(\"reload\"))\n}\n\nexport function BtnTransfer(onclick?: () => void, title: string = \"\"): Vnode<any, any> {\n\treturn BtnCustom(m.trust(transferSvg), onclick, title, Lang.get(\"transfer\"))\n\t\n}\n","import m, {Component, Vnode, VnodeDOM} from \"mithril\";\nimport {LoadedStatistics} from \"../loader/csv/CsvLoaderCollectionFromCharts\";\nimport {ChartJsBox} from \"../helpers/ChartJsBox\";\nimport {ObserverId} from \"../observable/BaseObservable\";\nimport {ChartData} from \"../data/study/ChartData\";\nimport {LoadingSpinner} from \"./LoadingSpinner\";\nimport {ObservablePromise} from \"../observable/ObservablePromise\";\n\ninterface ChartComponentOptions {\n\tpromise: ObservablePromise<LoadedStatistics>\n\tchart: ChartData\n\tclassName?: string //in case the parent has added a className that we need to include\n\tnoSort: boolean\n}\n\nclass ChartComponent implements Component<ChartComponentOptions, any> {\n\tprivate enabled: boolean = false\n\tprivate chart?: ChartData\n\tprivate chartView?: HTMLElement\n\tprivate chartViewBox?: ChartJsBox\n\tprivate promiseObserverId?: ObserverId\n\t\n\t\n\tprivate async drawGraph(chart: ChartData, promise: Promise<LoadedStatistics>, noSort: boolean): Promise<void> {\n\t\tthis.enabled = false\n\t\tm.redraw()\n\t\t\n\t\tconst data = await promise\n\t\tconst view = this.chartView\n\t\t\n\t\tif(!view)\n\t\t\treturn\n\t\twhile(view?.hasChildNodes()) {\n\t\t\tview.removeChild(view.lastChild!)\n\t\t}\n\t\t\n\t\tthis.chartViewBox = new ChartJsBox(view, data.mainStatistics, data.additionalStatistics ?? {}, chart, noSort)\n\t\tthis.enabled = true\n\t\tm.redraw()\n\t}\n\t\n\tpublic oncreate(vNode: VnodeDOM<ChartComponentOptions, any>): void {\n\t\tconst promise = vNode.attrs.promise\n\t\tconst chart = vNode.attrs.chart\n\t\tconst noSort = vNode.attrs.noSort\n\t\tthis.chart = chart\n\t\tthis.chartView = vNode.dom.getElementsByClassName(\"chartViewWindow\")[0] as HTMLElement\n\t\t\n\t\tthis.drawGraph(chart, promise.get(), noSort)\n\t\tthis.promiseObserverId = promise.addObserver(() => {\n\t\t\tthis.drawGraph(chart, promise.get(), noSort)\n\t\t})\n\t}\n\t\n\tpublic onupdate(vNode: VnodeDOM<ChartComponentOptions, any>): void {\n\t\t//when a section is replaced with another section with the same content (but from a different study), mithril js will not reload this ChartView but call onupdate instead\n\t\tconst promise = vNode.attrs.promise\n\t\tconst chart = vNode.attrs.chart\n\t\tconst noSort = vNode.attrs.noSort\n\t\t\n\t\tif(chart != this.chart) {\n\t\t\tthis.chart = chart\n\t\t\tthis.drawGraph(chart, promise.get(), noSort)\n\t\t\tthis.promiseObserverId?.removeObserver()\n\t\t\t\n\t\t\tthis.promiseObserverId = promise.addObserver(() => {\n\t\t\t\tthis.drawGraph(chart, promise.get(), noSort)\n\t\t\t})\n\t\t}\n\t}\n\t\n\tpublic onremove(): void {\n\t\tthis.promiseObserverId?.removeObserver()\n\t}\n\t\n\tpublic view(vNode: VnodeDOM<ChartComponentOptions, any>): Vnode<any, any> {\n\t\treturn <div class={`chartView center ${vNode.attrs.className ?? \"\"}`}>\n\t\t\t<div class={`chartViewWindow ${this.enabled ? \"fadeIn\" : \"\"}`}></div>\n\t\t\t{!this.enabled &&\n\t\t\t\tLoadingSpinner()\n\t\t\t}\n\t\t</div>\n\t}\n}\n\nexport function ChartView(chart: ChartData, promise: ObservablePromise<LoadedStatistics>, noSort: boolean = false) {\n\treturn m(ChartComponent, {\n\t\tchart: chart,\n\t\tpromise: promise,\n\t\tnoSort: noSort\n\t})\n}","import m, {Vnode} from \"mithril\"\nimport {NotCompatibleIcon, PossibleDevices} from \"./NotCompatibleIcon\";\n\ntype DashTemplateOptions = {\n\ttitle: string\n\ticon?: Vnode<any, any>\n\tnoCompatibilityIcon?: PossibleDevices[]\n\tmsg?: string | Vnode<any, any>\n\tinnerLinkTitle?: string\n\tinnerLinkHref?: string\n}\n\ntype DashContainerOptions = \"stretched\" | \"cramped\" | \"vertical\" | \"horizontal\" | null\nexport type DashViewOptions = {\n\tdisabled?: boolean\n\tonclick?: (e: MouseEvent) => void\n\thref?: string\n\tshowAsClickable?: boolean\n\tfloating?: boolean\n\tfloatingRight?: boolean\n\thighlight?: boolean\n\tsmall?: boolean\n\ttemplate?: DashTemplateOptions\n\tcontent?: Vnode<any, any>\n}\n\nfunction DashTemplateView(options: DashTemplateOptions): Vnode<any, any> {\n\treturn (\n\t\t<div>\n\t\t\t{(options.icon || options.noCompatibilityIcon) &&\n\t\t\t\t<div class=\"dashIcon\">\n\t\t\t\t\t{options.icon}\n\t\t\t\t\t{options.noCompatibilityIcon && NotCompatibleIcon(... options.noCompatibilityIcon)}\n\t\t\t\t</div>\n\t\t\t}\n\t\t\t\n\t\t\t<div class=\"dashTitle\">{options.title}</div>\n\t\t\t{options.msg && <p class=\"dashMsg\">{options.msg}</p>}\n\t\t\t{options.innerLinkTitle && options.innerLinkHref && <a class=\"link\" href={options.innerLinkHref}>{options.innerLinkTitle}</a>}\n\t\t</div>\n\t)\n}\n\nfunction DashElementView(options: DashViewOptions): Vnode<any, any> {\n\tlet classString = \"dashEl\"\n\tif(options.floatingRight)\n\t\tclassString += \" floating right\"\n\telse if(options.floating)\n\t\tclassString += \" floating\"\n\t\n\tif(options.small)\n\t\tclassString += \" small\"\n\tif(options.highlight)\n\t\tclassString += \" highlight\"\n\tif(options.disabled)\n\t\tclassString += \" disabled\"\n\t\n\tlet view: Vnode<any, any>\n\tif(options.content)\n\t\tview = options.content\n\telse if(options.template)\n\t\tview = DashTemplateView(options.template)\n\telse\n\t\tview = <div class=\"highlight\">Missing Dash Information</div>\n\t\n\tif(options.href) {\n\t\treturn <a target={options.href.startsWith(\"http\") ? \"_blank\" : \"\"} class={`${classString} dashLink`} href={options.href}>{view}</a>\n\t}\n\telse if(options.onclick)\n\t\treturn <a class={`${classString} dashLink`} onclick={options.onclick}>{view}</a>\n\telse if(options.showAsClickable)\n\t\treturn <a class={`${classString} dashLink`}>{view}</a>\n\telse {\n\t\tview.attrs[\"className\"] = `${classString} ${view.attrs.hasOwnProperty(\"className\") ? view.attrs[\"className\"] : \"\"}`\n\t\treturn view\n\t}\n}\n\nfunction getNewClassString(size: DashContainerOptions, oldClassString: string): string {\n\tif(size)\n\t\toldClassString += \" \" + size\n\treturn oldClassString\n}\n\nexport function DashElement(\n\tsize: DashContainerOptions,\n\t... options: (DashViewOptions | false)[]\n): Vnode<any, any> {\n\tif(options.length == 1) {\n\t\tif(!options[0])\n\t\t\treturn <div></div>\n\t\t\n\t\tconst view =  DashElementView(options[0])\n\t\tview.attrs[\"className\"] = getNewClassString(size, view.attrs[\"className\"])\n\t\treturn view\n\t}\n\telse {\n\t\tconst classString = getNewClassString(size, \"multipleChildren\")\n\t\treturn <div class={classString}>\n\t\t\t{options.map((option) => option && DashElementView(option))}\n\t\t</div>\n\t}\n}","import m, {Vnode} from \"mithril\"\nexport function DashRow(... content: Array<Vnode<any, any> | undefined | false>): Vnode<any, any> {\n\treturn (\n\t\t<div class=\"dashRow\">{content}</div>\n\t)\n}","import m, {Component, Vnode, VnodeDOM} from \"mithril\"\nimport addSvg from \"../../imgs/icons/dragHandle.svg?raw\"\nimport {BaseObservable} from \"../observable/BaseObservable\";\nimport {ArrayInterface} from \"../observable/interfaces/ArrayInterface\";\n\nexport interface DragTools {\n\tgetDragTarget(index: number, targetList: ArrayType, content?: Vnode<any, any>): Vnode<any, any>\n\tgetDragStarter(index: number, dragTarget: ArrayType): Vnode<any, any>\n}\n\ntype ArrayType = ArrayInterface<any, BaseObservable<any>>\n\ninterface DragContainerImpOptions {\n\tcontent: (container: DragTools) => Vnode<any, any>\n}\nclass DragContainerImp implements DragTools, Component<DragContainerImpOptions, any> {\n\tprivate contentVNode?: VnodeDOM<any, any>\n\tprivate currentStartList?: ArrayType\n\tprivate currentTargetList?: ArrayType\n\tprivate currentStartIndex: number = 0\n\tprivate currentTargetIndex: number = 0\n\tprivate currentDragClone?: HTMLElement\n\tprivate currentStartElement?: HTMLElement\n\tprivate startIndex: number = 0\n\t\n\tpublic getDragTarget(index: number, targetList: ArrayType, content: Vnode<any, any> = <div></div>): Vnode<any, any> {\n\t\tcontent.attrs[\"className\"] = `dragTarget ${content.attrs[\"className\"] ?? \"\"}`\n\t\tcontent.attrs[\"ondragend\"] = this.ondragend.bind(this)\n\t\tcontent.attrs[\"ondragenter\"] = this.ondragenter.bind(this, index, targetList)\n\t\treturn content\n\t}\n\t\n\tpublic getDragStarter(index: number, targetList: ArrayType): Vnode<any, any> {\n\t\treturn <div class=\"btn clickable dragStarter\" draggable=\"true\" ondragstart={this.ondragstart.bind(this, index, targetList)}>\n\t\t\t{m.trust(addSvg)}\n\t\t</div>\n\t}\n\t\n\t\n\tprivate getIndexInContainer(searchEl: HTMLElement): number {\n\t\tconst htmlCollection = this.contentVNode?.dom.getElementsByClassName(\"dragTarget\")\n\t\tif(htmlCollection) {\n\t\t\tfor(let i = htmlCollection.length - 1; i >= 0; --i) {\n\t\t\t\tif(htmlCollection[i] === searchEl)\n\t\t\t\t\treturn i\n\t\t\t}\n\t\t}\n\t\treturn -1\n\t}\n\t\n\tprivate addDragSpacer(locationEl: HTMLElement): void {\n\t\tlet insertBefore: Element | null = locationEl //when insertBefore is null, currentDragClone will be placed at the end\n\t\tif(!this.currentDragClone)\n\t\t\treturn\n\t\tif(this.currentDragClone.parentNode) {\n\t\t\tconst locationIndex = this.getIndexInContainer(locationEl)\n\t\t\tconst spacerIndex = this.getIndexInContainer(this.currentDragClone)\n\t\t\t\n\t\t\tif(spacerIndex < this.startIndex) { //mouse moved up (/right) from starting point\n\t\t\t\tif(spacerIndex < locationIndex) { //mouse is moving down (/left) again\n\t\t\t\t\tinsertBefore = locationEl.nextElementSibling\n\t\t\t\t\t++this.currentTargetIndex\n\t\t\t\t}\n\t\t\t}\n\t\t\telse { //mouse moved down (/left) from starting point\n\t\t\t\t\n\t\t\t\t//we need to add one to targetIndex.\n\t\t\t\t// But when we are in the same list, removing the item (before moving it) means that targetIndex points to the element afterwards anyway.\n\t\t\t\t// But when we are in another list, we need to correct manually:\n\t\t\t\tif(this.currentStartList != this.currentTargetList)\n\t\t\t\t\t++this.currentTargetIndex\n\t\t\t\t\n\t\t\t\tif(spacerIndex > locationIndex) //mouse is moving up (/right) again\n\t\t\t\t\t--this.currentTargetIndex\n\t\t\t\telse\n\t\t\t\t\tinsertBefore = locationEl.nextElementSibling\n\t\t\t}\n\t\t\tthis.currentDragClone.parentNode.removeChild(this.currentDragClone)\n\t\t}\n\t\tlocationEl.parentNode?.insertBefore(this.currentDragClone, insertBefore)\n\t}\n\t\n\tprivate ondragstart(index: number, targetList: ArrayType, e: DragEvent): boolean {\n\t\tlet targetElement = e.currentTarget as HTMLElement\n\t\twhile(targetElement && !targetElement.classList.contains(\"dragTarget\")) {\n\t\t\ttargetElement = targetElement.parentNode as HTMLElement\n\t\t}\n\t\tconst dragRoot = this.contentVNode?.dom\n\t\tif(!dragRoot)\n\t\t\treturn false\n\t\t\n\t\t\n\t\tthis.startIndex = this.getIndexInContainer(targetElement)\n\t\t\n\t\tthis.currentStartList = targetList\n\t\tthis.currentStartIndex = index\n\t\t\n\t\tthis.currentDragClone = targetElement.cloneNode(true) as HTMLElement\n\t\tthis.currentDragClone?.classList.add(\"drag_spacer\")\n\t\t\n\t\tthis.currentDragClone?.addEventListener(\"dragover\", this.ondragover.bind(this))\n\t\tthis.currentDragClone?.addEventListener(\"dragleave\", this.ondragleave.bind(this))\n\t\tthis.currentDragClone?.addEventListener(\"drop\", this.ondrop.bind(this))\n\t\t\n\t\ttargetElement.classList.add(\"dragStarted\")\n\t\te.dataTransfer?.setDragImage(targetElement, 0, 0)\n\t\t\n\t\t\n\t\tthis.currentStartElement = targetElement\n\t\t\n\t\twindow.setTimeout( () => {\n\t\t\t//in firefox: setDragImage() seems to stop working when the class of document.body is changed\n\t\t\t//in chrome: DOM changes seem to cancel dragging altogether\n\t\t\t//solution: doing this stuff in a different \"thread\" seems to do the trick\n\t\t\tthis.addDragSpacer(targetElement)\n\t\t\tdragRoot.classList.add(\"is_dragging\")\n\t\t}, 0)\n\t\treturn true\n\t}\n\tprivate ondragend(e: DragEvent): void {\n\t\tthis.ondragleave(e)\n\t\te.preventDefault()\n\t\t\n\t\tthis.contentVNode?.dom.classList.remove(\"is_dragging\")\n\t\tthis.currentStartElement?.classList.remove(\"dragStarted\")\n\t\tif(this.currentDragClone?.parentNode)\n\t\t\tthis.currentDragClone.parentNode.removeChild(this.currentDragClone)\n\t\t\n\t\tthis.currentDragClone = undefined\n\t}\n\tprivate ondragenter(index: number, targetList: ArrayType, e: DragEvent): false {\n\t\tconst targetElement = e.currentTarget as HTMLElement\n\t\tif(!this.contentVNode?.dom.contains(targetElement))\n\t\t\treturn false\n\t\t\n\t\tif(e.dataTransfer)\n\t\t\te.dataTransfer.dropEffect = \"none\"\n\t\te.preventDefault()\n\t\t\n\t\tthis.currentTargetList = targetList\n\t\tthis.currentTargetIndex = index\n\t\t\n\t\tthis.addDragSpacer(targetElement)\n\t\treturn false\n\t}\n\t\n\tprivate ondragover(e: DragEvent): void {\n\t\te.preventDefault()\n\t\tif(e.dataTransfer)\n\t\t\te.dataTransfer.dropEffect = \"move\"\n\t}\n\tprivate ondragleave(e: DragEvent): void {\n\t\te.preventDefault()\n\t}\n\tprivate ondrop(e: DragEvent): void {\n\t\te.preventDefault()\n\t\t\n\t\tif(this.currentStartList == null || this.currentTargetList == null)\n\t\t\treturn\n\t\t\n\t\tif(this.currentTargetList == this.currentStartList)\n\t\t\tthis.currentTargetList.move(this.currentStartIndex, this.currentTargetIndex)\n\t\telse\n\t\t\tthis.currentTargetList.moveFromOtherList(this.currentStartList, this.currentStartIndex, this.currentTargetIndex)\n\t\t\n\t\tthis.currentStartList = this.currentTargetList = undefined\n\t\tthis.ondragend(e)\n\t}\n\t\n\tpublic onupdate(vNode: VnodeDOM<DragContainerImpOptions, any>): void {\n\t\tthis.contentVNode = vNode\n\t}\n\t\n\tpublic view(vNode: Vnode<DragContainerImpOptions, any>): Vnode<any, any> {\n\t\treturn vNode.attrs.content(this)\n\t}\n}\n\n\nexport function DragContainer(\n\tcontent: (container: DragTools) => Vnode<any, any>\n): Vnode<any, any> {\n\treturn m(DragContainerImp, { content: content })\n}","import m, {Vnode} from \"mithril\"\nimport {Lang} from \"../singletons/Lang\";\nimport androidSvg from \"../../imgs/devices/android.svg?raw\"\nimport iosSvg from \"../../imgs/devices/ios.svg?raw\"\nimport webSvg from \"../../imgs/devices/web.svg?raw\"\nimport {closeDropdown, openDropdown} from \"./DropdownMenu\";\n\n\nexport type PossibleDevices = \"Android\" | \"iOS\" | \"Web\"\n\nconst imageRecord: Record<PossibleDevices, string> = {\n\tAndroid: androidSvg,\n\tiOS: iosSvg,\n\tWeb: webSvg\n}\n\nfunction onPointerEnter(title: string, e: MouseEvent) {\n\topenDropdown(\"notCompatible\", e.target as HTMLElement,\n\t\t() => <div class=\"smallText center\">{title}</div>\n\t)\n}\nfunction onPointerLeave() {\n\tcloseDropdown(\"notCompatible\")\n}\n\nexport function NotCompatibleIcon(... devices: PossibleDevices[]): Vnode<any, any> {\n\tconst translationRecord: Record<PossibleDevices, string> = {\n\t\tAndroid: Lang.get(\"Android\"),\n\t\tiOS: Lang.get(\"iOS\"),\n\t\tWeb: Lang.get(\"web_questionnaire\")\n\t}\n\tconst title = Lang.get(\"not_compatible_with\", devices.map((device) => translationRecord[device]).join(\", \"))\n\treturn <div class=\"notCompatibleIcon\" onpointerenter={onPointerEnter.bind(null, title)} onpointerleave={onPointerLeave.bind(null)}>\n\t\t{devices.map((device) =>\n\t\t\t<div class=\"deviceIcon\">{m.trust(imageRecord[device])}</div>)}\n\t</div>\n\n}\n","import m, {Vnode} from \"mithril\"\nimport {ObservablePrimitive} from \"../observable/ObservablePrimitive\";\nimport {DragContainer} from \"./DragContainer\";\nimport {BaseObservable} from \"../observable/BaseObservable\";\nimport {ArrayInterface} from \"../observable/interfaces/ArrayInterface\";\n\nexport interface TabContent {\n\ttitle: string | Vnode<any, any>\n\tdraggableList?: ArrayInterface<any, BaseObservable<any>>\n\thighlight?: boolean\n\tview: () => Vnode<any, any>\n}\n\nexport function TabBar(selectedIndex: ObservablePrimitive<number>, tabs: (TabContent | undefined | false)[], smallBar: boolean = false, addBtnCallback?: (e: MouseEvent) => void): Vnode<any, any> {\n\tif(!tabs.length)\n\t\treturn (<div></div>)\n\t\n\tif(selectedIndex.get() >= tabs.length)\n\t\tselectedIndex.set(0)\n\treturn (\n\t\tDragContainer((dragTools) => {\n\t\t\tconst selectedTab = tabs[selectedIndex.get()]\n\t\t\treturn <div>\n\t\t\t\t<div>\n\t\t\t\t\t<div class={smallBar ? \"tabBar smallBar\" : \"tabBar\"}>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttabs.map((tab, index) => {\n\t\t\t\t\t\t\t\tif(!tab)\n\t\t\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t\t\tconst className = `tab ${(selectedIndex.get() == index) ? \"selected\" : \"\"} ${tab.highlight ? \"highlight\" : \"\"}`\n\t\t\t\t\t\t\t\tconst content = <div class={className} onclick={() => {selectedIndex.set(index)}}>\n\t\t\t\t\t\t\t\t\t<div class=\"left\">\n\t\t\t\t\t\t\t\t\t\t{tab.draggableList && dragTools.getDragStarter(index, tab.draggableList)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<span class=\"middle\">{tab.title}</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\treturn tab.draggableList\n\t\t\t\t\t\t\t\t\t? dragTools.getDragTarget(index, tab.draggableList, content)\n\t\t\t\t\t\t\t\t\t: content\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{addBtnCallback &&\n\t\t\t\t\t\t\t<div class=\"tab addBtn\" onclick={addBtnCallback}>\n\t\t\t\t\t\t\t\t<span class=\"middle\">+</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tabContent\">\n\t\t\t\t\t{selectedTab && selectedTab.view()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t})\n\t)\n}"],"names":["value","parent","key","keyName","backingField","reCalcIsDifferent","_","createJson","isDifferent","get","this","set","silently","hasMutated","setValue","Promise","resolve","section","serverStatistics","appTypeChart","createAppTypeChart","dailyQuestionnaireChart","createDailyQuestionnaireChart","dailyJoinedChart","createDailyJoinedChart","weekdaysQuestionnaireChart","createWeekdaysQuestionnaireChart","weekdaysJoinedChart","createWeekdaysJoinedChart","appTypePromise","createChartPromise","storageType","data","total","android","ios","web","entryCount","timeInterval","dailyQuestionnairePromise","createDailyStatisticsEntry","dailyJoinedPromise","weekdaysQuestionnairePromise","createWeeklyStatisticsEntry","weekdaysJoinedPromise","preLoad","_section","loadJson","titleExtra","reload","bind","variable","entries","mainStatistics","type","week","subVariable","statisticsData","count","days","timestamp","entry","hasOwnProperty","sum","title","publicVariables","axisContainer","xAxis","conditions","yAxis","variableName","observedVariableIndex","valueType","dataType","chartType","createDailyAppVersionChart","appVersionAxisContainer","label","color","getView","content","class","getWithColon","studies","questionnaire","users","dailyAppVersionPromise","dailyAppVersionChart","Date","created","toLocaleDateString","lastActivities","usedSpace","tabIndex","lastActivitiesList","studyId","push","id","parseInt","sort","a","b","usedSpaceList","totalUsedSpace","fileSize","setAppVersionChartAndPromise","getStrippedStudyListPromise","appVersionLabels","appVersion","appVersionStatistics","i","Object","keys","indexOf","getReadableByteSize","bytes","Math","round","siteData","studyLoader","getStudies","view","style","map","study","getEntry","published","href","getUrl","now","toLocaleString","tools","getTools","totalDiskSpace","freeDiskSpace","colspan","preInit","hasAlternatives","getAlternatives","getDynamic","defaultValue","setDynamic","newValue","dynamicValues","setChild","getStaticInt","getStaticString","getStudyOrNull","getCount","getFirst","getStudyOrThrow","Error","getQuestionnaireOrNull","qId","questionnaires","internalId","getQuestionnaireOrThrow","getAdmin","hasPermission","name","isLoggedIn","depth","getHash","goTo","target","window","location","hash","newSection","destroy","BtnCustom","icon","onclick","hoverTitle","BtnRemove","BtnTrash","BtnAdd","BtnCopy","BtnEdit","BtnOk","BtnReload","BtnTransfer","enabled","drawGraph","chart","promise","noSort","chartView","hasChildNodes","removeChild","lastChild","chartViewBox","additionalStatistics","oncreate","vNode","attrs","dom","getElementsByClassName","promiseObserverId","addObserver","onupdate","removeObserver","onremove","className","ChartView","ChartComponent","DashElementView","options","classString","floatingRight","floating","small","highlight","disabled","template","noCompatibilityIcon","msg","innerLinkTitle","innerLinkHref","DashTemplateView","startsWith","showAsClickable","getNewClassString","size","oldClassString","DashElement","length","option","DashRow","currentStartIndex","currentTargetIndex","startIndex","getDragTarget","index","targetList","ondragend","ondragenter","getDragStarter","draggable","ondragstart","getIndexInContainer","searchEl","htmlCollection","contentVNode","addDragSpacer","locationEl","insertBefore","currentDragClone","parentNode","locationIndex","spacerIndex","nextElementSibling","currentStartList","currentTargetList","e","targetElement","currentTarget","classList","contains","dragRoot","cloneNode","add","addEventListener","ondragover","ondragleave","ondrop","dataTransfer","setDragImage","currentStartElement","setTimeout","preventDefault","remove","undefined","dropEffect","move","moveFromOtherList","DragContainer","DragContainerImp","imageRecord","Android","iOS","Web","onPointerEnter","onPointerLeave","NotCompatibleIcon","translationRecord","Lang","devices","device","join","onpointerenter","onpointerleave","TabBar","selectedIndex","tabs","smallBar","addBtnCallback","dragTools","selectedTab","tab","draggableList"],"sourceRoot":""}