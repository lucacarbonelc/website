{"version":3,"file":"1192.b1f707627abbdbbec21c.js","mappings":"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","sources":["webpack://ESMira/./src/frontend/ts/pages/admin.tsx","webpack://ESMira/./src/frontend/ts/singletons/RssFetcher.ts","webpack://ESMira/./src/frontend/ts/widgets/NewsItem.tsx","webpack://ESMira/./src/frontend/ts/widgets/DashElement.tsx","webpack://ESMira/./src/frontend/ts/widgets/DashRow.tsx","webpack://ESMira/./src/frontend/ts/widgets/NotCompatibleIcon.tsx","webpack://ESMira/./src/frontend/ts/widgets/TitleRow.tsx"],"sourcesContent":["import {SectionContent} from \"../site/SectionContent\";\nimport m, {Vnode} from \"mithril\";\nimport {DashRow} from \"../widgets/DashRow\";\nimport {DashElement} from \"../widgets/DashElement\";\nimport {Lang} from \"../singletons/Lang\";\nimport addSvg from \"../../imgs/icons/add.svg?raw\"\nimport dataSvg from \"../../imgs/icons/data.svg?raw\"\nimport editSvg from \"../../imgs/icons/change.svg?raw\"\nimport editAccountSvg from \"../../imgs/dashIcons/editAccount.svg?raw\"\nimport editUsersSvg from \"../../imgs/dashIcons/editUsers.svg?raw\"\nimport errorReportsSvg from \"../../imgs/dashIcons/errorReports.svg?raw\"\nimport logoutSvg from \"../../imgs/dashIcons/logout.svg?raw\"\nimport messagesSvg from \"../../imgs/icons/message.svg?raw\"\nimport serverStatisticsSvg from \"../../imgs/dashIcons/serverStatistics.svg?raw\"\nimport serverSettingsSvg from \"../../imgs/dashIcons/settings.svg?raw\"\nimport {TitleRow} from \"../widgets/TitleRow\";\nimport {AddDropdownMenus} from \"../helpers/AddDropdownMenus\";\nimport { RssFetcher, RssItem } from \"../singletons/RssFetcher\";\nimport { NewsItem } from \"../widgets/NewsItem\";\nimport { Section } from \"../site/Section\";\nimport { Requests } from \"../singletons/Requests\";\nimport { FILE_ADMIN } from \"../constants/urls\";\nimport { BtnTrash } from \"../widgets/BtnWidgets\";\n\nconst MINIMAL_DISK_SPACE = 1000 * 1000 * 100 //100 Mb\n/**\n * This section needs to be the very first section to make sure that {@link Admin.tools} is loaded\n * {@link Site.constructor()} check for \"admin\" in the url hash\n */\nexport class Content extends SectionContent {\n\tprivate readonly addDropdownMenus = new AddDropdownMenus(this)\n\tprivate rssItems: RssItem[]\n\n\tpublic static preLoad(section: Section): Promise<any>[] {\n\t\treturn [\n\t\t\tRssFetcher.loadFeed(3)\n\t\t\t\t.catch(() => {\n\t\t\t\t\tsection.loader.error(Lang.get(\"error_news\"))\n\t\t\t\t\treturn []\n\t\t\t\t})\n\t\t]\n\t}\n\n\tconstructor(section: Section, rssItems: RssItem[]) {\n\t\tsuper(section)\n\t\tthis.rssItems = rssItems\n\t}\n\n\tpublic title(): string {\n\t\treturn Lang.get(\"admin\")\n\t}\n\t\n\tprivate async addStudy(e: MouseEvent): Promise<void> {\n\t\treturn this.addDropdownMenus.addStudy(e.target as Element)\n\t}\n\t\n\tprivate logout(): Promise<void> {\n\t\treturn this.section.loader.showLoader(this.getAdmin().logout())\n\t}\n\n\tprivate editBookmark(url: string, oldName: string) {\n\t\tconst newName = prompt(Lang.get(\"prompt_bookmark_name\"), oldName)\n\t\tif(!newName)\n\t\t\treturn\n\t\tthis.getAdmin().getTools().bookmarksLoader.setBookmark(url, newName)\n\t}\n\n\tprivate bookmarkList(): Vnode<any, any> {\n\t\tconst bookmarksLoader = this.getAdmin().getTools().bookmarksLoader\n\n\t\treturn <div class=\"listParent\">\n\t\t\t<div class=\"listChild\">\n\t\t\t\t{bookmarksLoader.getBookmarkList().sort((bookmarkA, bookmarkB) => {\n\t\t\t\t\treturn bookmarkA.alias.get().localeCompare(bookmarkB.alias.get())\n\t\t\t\t}).map((bookmark) => {\n\t\t\t\t\treturn <div>\n\t\t\t\t\t\t<a class=\"btn\" onclick={this.editBookmark.bind(this, bookmark.url.get(), bookmark.alias.get())}>{m.trust(editSvg)}</a>\n\t\t\t\t\t\t<a href={bookmark.url.get()}>{bookmark.alias.get()}</a>\n\t\t\t\t\t</div>\n\t\t\t\t})}\n\t\t\t</div>\n\t\t</div>\n\t}\n\t\n\tpublic getView(): Vnode<any, any> {\n\t\tconst tools = this.getTools()\n\t\treturn <div>\n\t\t\t{\n\t\t\t\tDashRow(\n\t\t\t\t\ttools.isAdmin && tools.freeDiskSpace < MINIMAL_DISK_SPACE &&\n\t\t\t\t\tDashElement(\"stretched\", {\n\t\t\t\t\t\thighlight: true,\n\t\t\t\t\t\tsmall: true,\n\t\t\t\t\t\tcontent: <div class=\"highlight\">{Lang.get(\"info_low_disk_space\", Math.round(tools.freeDiskSpace / 1000 / 1000))}</div>\n\t\t\t\t\t}),\n\t\t\t\t\t\n\t\t\t\t\t(tools.permissions.write || tools.canCreate) &&\n\t\t\t\t\tDashElement(null,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttemplate: { title: Lang.get(\"edit_studies\"), icon: m.trust(editSvg) },\n\t\t\t\t\t\t\thref: this.getUrl(\"allStudies:edit\")\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttools.canCreate && {\n\t\t\t\t\t\t\tfloating: true,\n\t\t\t\t\t\t\ttemplate: {title: Lang.get(\"create\"), icon: m.trust(addSvg) },\n\t\t\t\t\t\t\tonclick: this.addStudy.bind(this)\n\t\t\t\t\t\t},\n\t\t\t\t\t),\n\t\t\t\t\t\n\t\t\t\t\ttools.permissions.msg &&\n\t\t\t\t\t\tDashElement(null, {\n\t\t\t\t\t\t\thighlight: !!(tools.messagesLoader.studiesWithNewMessagesCount.get()),\n\t\t\t\t\t\t\ttemplate: {title: Lang.get(\"messages\"), icon: m.trust(messagesSvg) },\n\t\t\t\t\t\t\thref: this.getUrl(\"allStudies:msgs\")\n\t\t\t\t\t\t}),\n\t\t\t\t\t\n\t\t\t\t\ttools.permissions.read &&\n\t\t\t\t\t\tDashElement(null, {\n\t\t\t\t\t\t\thighlight: !!(tools.merlinLogsLoader.studiesWithNewMerlinLogsCount.get()),\n\t\t\t\t\t\t\ttemplate: {title: Lang.get(\"show_data_statistics\"), icon: m.trust(dataSvg) },\n\t\t\t\t\t\t\thref: this.getUrl(\"allStudies:data\")\n\t\t\t\t\t\t}),\n\t\t\t\t\t\n\t\t\t\t\ttools?.isAdmin &&\n\t\t\t\t\t\tDashElement(null, {\n\t\t\t\t\t\t\ttemplate: {title: Lang.get(\"show_server_statistics\"), icon: m.trust(serverStatisticsSvg) },\n\t\t\t\t\t\t\thref: this.getUrl(\"serverStatisticsAdmin\")\n\t\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t}\n\t\t\t{\n\t\t\t\t!this.getAdmin().getTools().bookmarksLoader.isBookmarkListEmpty() &&\n\t\t\t\t<div>\n\t\t\t\t\t{\n\t\t\t\t\t\tTitleRow(Lang.getWithColon(\"bookmarks\"))\n\t\t\t\t\t}\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.bookmarkList()\n\t\t\t\t\t}\t\n\t\t\t\t</div>\n\t\t\t}\n\t\t\t{\n\t\t\t\ttools?.isAdmin &&\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tTitleRow(Lang.getWithColon(\"server\"))\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDashRow(\n\t\t\t\t\t\t\t\tDashElement(null, {\n\t\t\t\t\t\t\t\t\ttemplate: {title: Lang.get(\"edit_users\"), icon: m.trust(editUsersSvg) },\n\t\t\t\t\t\t\t\t\thref: this.getUrl(\"accountList\")\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tDashElement(null, {\n\t\t\t\t\t\t\t\t\ttemplate: {title: Lang.get(\"server_settings\"), icon: m.trust(serverSettingsSvg) },\n\t\t\t\t\t\t\t\t\thref: this.getUrl(\"serverSettings\")\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tDashElement(null, {\n\t\t\t\t\t\t\t\t\thighlight: tools?.hasErrors,\n\t\t\t\t\t\t\t\t\ttemplate: {title: Lang.get(\"show_errorReports\"), icon: m.trust(errorReportsSvg) },\n\t\t\t\t\t\t\t\t\thref: this.getUrl(\"errorList\")\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t}\n\t\t\t<br/>\n\t\t\t{\n\t\t\t\tDashRow(\n\t\t\t\t\tDashElement(null, {\n\t\t\t\t\t\tsmall: true,\n\t\t\t\t\t\ttemplate: {title: Lang.get(\"edit_user_account\"), icon: m.trust(editAccountSvg) },\n\t\t\t\t\t\thref: this.getUrl(\"myAccount\")\n\t\t\t\t\t}),\n\t\t\t\t\tDashElement(null, {\n\t\t\t\t\t\tsmall: true,\n\t\t\t\t\t\ttemplate: {title: Lang.get(\"logout_x\", tools?.accountName), icon: m.trust(logoutSvg)},\n\t\t\t\t\t\tonclick: this.logout.bind(this)\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t}\n\t\t\t<br/>\n\t\t\t{ !!this.rssItems.length &&\n\t\t\t\t<div>\n\t\t\t\t\t{\n\t\t\t\t\t\tTitleRow(Lang.getWithColon(\"news\"))\n\t\t\t\t\t}\n\t\t\t\t\t<div>\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.rssItems.map(item => {\n\t\t\t\t\t\t\treturn NewsItem(item)\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t}\n\t\t</div>\n\t\t\n\t}\n}","import {URL_BLOG_RSS} from \"../constants/urls\"\nimport {Requests} from \"./Requests\"\n\n\nexport type RssItem = {\n\ttitle: string\n\tdate: string\n\tlink: string\n}\n\nexport const RssFetcher = {\n\tloadFeed(max_num_items: number): Promise<RssItem[]> {\n\t\treturn Requests.loadRaw(URL_BLOG_RSS).then(\n\t\t\t(feed: string) => {\n\t\t\t\tconst parser = new DOMParser()\n\t\t\t\tconst xmlDoc = parser.parseFromString(feed, \"application/xml\")\n\t\t\t\t\n\t\t\t\tconst entries = xmlDoc.getElementsByTagName(\"entry\")\n\t\t\t\tlet items: RssItem[] = []\n\t\t\t\tfor(let i = 0; i < Math.min(entries.length, max_num_items); i++) {\n\t\t\t\t\tconst entry = entries[i]\n\t\t\t\t\tconst title = entry.getElementsByTagName('title')[0]?.textContent ?? \"\"\n\t\t\t\t\tconst link = entry.getElementsByTagName('link')[0]?.getAttribute('href') ?? \"\"\n\t\t\t\t\tconst date = entry.getElementsByTagName('updated')[0]?.textContent ?? \"\"\n\t\t\t\t\t\n\t\t\t\t\titems.push({title: title, link: link, date: date})\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn items\n\t\t\t}\n\t\t)\n\t}\n}","import m, {Vnode} from \"mithril\"\nimport {RssItem} from \"../singletons/RssFetcher\"\nimport {Lang} from \"../singletons/Lang\"\n\nconst DAYS_FRESH = 7\n\nexport function NewsItem(\n\titem: RssItem\n): Vnode<any, any> {\n\tconst date = new Date(item.date)\n\tconst now = new Date()\n\tconst diffTime = Math.abs(date.getTime() - now.getTime())\n\tconst diffDays = Math.floor(diffTime / (1000 * 3600 * 24))\n\tlet dateString: String\n\tif(diffDays <= 0) {\n\t\tdateString = Lang.get(\"today\")\n\t} else {\n\t\tdateString = Lang.get(\"x_days_ago\", diffDays)\n\t}\n\tlet classString = \"newsItem\"\n\tif(diffDays < DAYS_FRESH) {\n\t\tclassString += \" \" + \"highlight\"\n\t}\n\treturn <div class={`${classString}`}>\n\t\t<div class=\"newsTitle\"><a href={`${item.link}`}>{item.title}</a></div>\n\t\t<div class=\"newsDate\"><span>{dateString}</span></div>\n\t</div>\n}","import m, {Vnode} from \"mithril\"\nimport {NotCompatibleIcon, PossibleDevices} from \"./NotCompatibleIcon\";\n\ntype DashTemplateOptions = {\n\ttitle: string\n\ticon?: Vnode<any, any>\n\tnoCompatibilityIcon?: PossibleDevices[]\n\tmsg?: string | Vnode<any, any>\n\tinnerLinkTitle?: string\n\tinnerLinkHref?: string\n}\n\ntype DashContainerOptions = \"stretched\" | \"cramped\" | \"vertical\" | \"horizontal\" | null\nexport type DashViewOptions = {\n\tdisabled?: boolean\n\tonclick?: (e: MouseEvent) => void\n\thref?: string\n\tshowAsClickable?: boolean\n\tfloating?: boolean\n\tfloatingRight?: boolean\n\thighlight?: boolean\n\tsmall?: boolean\n\ttemplate?: DashTemplateOptions\n\tcontent?: Vnode<any, any>\n}\n\nfunction DashTemplateView(options: DashTemplateOptions): Vnode<any, any> {\n\treturn (\n\t\t<div>\n\t\t\t{(options.icon || options.noCompatibilityIcon) &&\n\t\t\t\t<div class=\"dashIcon\">\n\t\t\t\t\t{options.icon}\n\t\t\t\t\t{options.noCompatibilityIcon && NotCompatibleIcon(... options.noCompatibilityIcon)}\n\t\t\t\t</div>\n\t\t\t}\n\t\t\t\n\t\t\t<div class=\"dashTitle\">{options.title}</div>\n\t\t\t{options.msg && <p class=\"dashMsg\">{options.msg}</p>}\n\t\t\t{options.innerLinkTitle && options.innerLinkHref && <a class=\"link\" href={options.innerLinkHref}>{options.innerLinkTitle}</a>}\n\t\t</div>\n\t)\n}\n\nfunction DashElementView(options: DashViewOptions): Vnode<any, any> {\n\tlet classString = \"dashEl\"\n\tif(options.floatingRight)\n\t\tclassString += \" floating right\"\n\telse if(options.floating)\n\t\tclassString += \" floating\"\n\t\n\tif(options.small)\n\t\tclassString += \" small\"\n\tif(options.highlight)\n\t\tclassString += \" highlight\"\n\tif(options.disabled)\n\t\tclassString += \" disabled\"\n\t\n\tlet view: Vnode<any, any>\n\tif(options.content)\n\t\tview = options.content\n\telse if(options.template)\n\t\tview = DashTemplateView(options.template)\n\telse\n\t\tview = <div class=\"highlight\">Missing Dash Information</div>\n\t\n\tif(options.href) {\n\t\treturn <a target={options.href.startsWith(\"http\") ? \"_blank\" : \"\"} class={`${classString} dashLink`} href={options.href}>{view}</a>\n\t}\n\telse if(options.onclick)\n\t\treturn <a class={`${classString} dashLink`} onclick={options.onclick}>{view}</a>\n\telse if(options.showAsClickable)\n\t\treturn <a class={`${classString} dashLink`}>{view}</a>\n\telse {\n\t\tview.attrs[\"className\"] = `${classString} ${view.attrs.hasOwnProperty(\"className\") ? view.attrs[\"className\"] : \"\"}`\n\t\treturn view\n\t}\n}\n\nfunction getNewClassString(size: DashContainerOptions, oldClassString: string): string {\n\tif(size)\n\t\toldClassString += \" \" + size\n\treturn oldClassString\n}\n\nexport function DashElement(\n\tsize: DashContainerOptions,\n\t... options: (DashViewOptions | false)[]\n): Vnode<any, any> {\n\tif(options.length == 1) {\n\t\tif(!options[0])\n\t\t\treturn <div></div>\n\t\t\n\t\tconst view =  DashElementView(options[0])\n\t\tview.attrs[\"className\"] = getNewClassString(size, view.attrs[\"className\"])\n\t\treturn view\n\t}\n\telse {\n\t\tconst classString = getNewClassString(size, \"multipleChildren\")\n\t\treturn <div class={classString}>\n\t\t\t{options.map((option) => option && DashElementView(option))}\n\t\t</div>\n\t}\n}","import m, {Vnode} from \"mithril\"\nexport function DashRow(... content: Array<Vnode<any, any> | undefined | false>): Vnode<any, any> {\n\treturn (\n\t\t<div class=\"dashRow\">{content}</div>\n\t)\n}","import m, {Vnode} from \"mithril\"\nimport {Lang} from \"../singletons/Lang\";\nimport androidSvg from \"../../imgs/devices/android.svg?raw\"\nimport iosSvg from \"../../imgs/devices/ios.svg?raw\"\nimport webSvg from \"../../imgs/devices/web.svg?raw\"\nimport {closeDropdown, openDropdown} from \"./DropdownMenu\";\n\n\nexport type PossibleDevices = \"Android\" | \"iOS\" | \"Web\"\n\nconst imageRecord: Record<PossibleDevices, string> = {\n\tAndroid: androidSvg,\n\tiOS: iosSvg,\n\tWeb: webSvg\n}\n\nfunction onPointerEnter(title: string, e: MouseEvent) {\n\topenDropdown(\"notCompatible\", e.target as HTMLElement,\n\t\t() => <div class=\"smallText center\">{title}</div>\n\t)\n}\nfunction onPointerLeave() {\n\tcloseDropdown(\"notCompatible\")\n}\n\nexport function NotCompatibleIcon(... devices: PossibleDevices[]): Vnode<any, any> {\n\tconst translationRecord: Record<PossibleDevices, string> = {\n\t\tAndroid: Lang.get(\"Android\"),\n\t\tiOS: Lang.get(\"iOS\"),\n\t\tWeb: Lang.get(\"web_questionnaire\")\n\t}\n\tconst title = Lang.get(\"not_compatible_with\", devices.map((device) => translationRecord[device]).join(\", \"))\n\treturn <div class=\"notCompatibleIcon\" onpointerenter={onPointerEnter.bind(null, title)} onpointerleave={onPointerLeave.bind(null)}>\n\t\t{devices.map((device) =>\n\t\t\t<div class=\"deviceIcon\">{m.trust(imageRecord[device])}</div>)}\n\t</div>\n\n}\n","import m, {Vnode} from \"mithril\"\nexport function TitleRow(\n\ttitle: string | Vnode<any, any>\n): Vnode<any, any> {\n\tif(typeof title == \"string\") {\n\t\treturn <div class=\"titleRow\">\n\t\t\t<span class=\"title\">{title}</span>\n\t\t</div>\n\t}\n\telse {\n\t\ttitle.attrs[\"className\"] = `titleRow ${title.attrs[\"className\"] ?? \"\"}`\n\t\treturn title\n\t}\n}"],"names":["section","rssItems","addDropdownMenus","AddDropdownMenus","preLoad","max_num_items","Requests","loadRaw","then","feed","entries","DOMParser","parseFromString","getElementsByTagName","items","i","Math","min","length","entry","title","textContent","link","getAttribute","date","push","catch","loader","error","Lang","get","addStudy","e","this","target","logout","showLoader","getAdmin","editBookmark","url","oldName","newName","prompt","getTools","bookmarksLoader","setBookmark","bookmarkList","class","getBookmarkList","sort","bookmarkA","bookmarkB","alias","localeCompare","map","bookmark","onclick","bind","href","getView","tools","DashRow","isAdmin","freeDiskSpace","DashElement","highlight","small","content","round","permissions","write","canCreate","template","icon","getUrl","floating","msg","messagesLoader","studiesWithNewMessagesCount","read","merlinLogsLoader","studiesWithNewMerlinLogsCount","isBookmarkListEmpty","TitleRow","getWithColon","hasErrors","accountName","item","dateString","Date","now","diffTime","abs","getTime","diffDays","floor","classString","NewsItem","SectionContent","DashElementView","options","view","floatingRight","disabled","noCompatibilityIcon","innerLinkTitle","innerLinkHref","DashTemplateView","startsWith","showAsClickable","attrs","hasOwnProperty","getNewClassString","size","oldClassString","option","imageRecord","Android","iOS","Web","onPointerEnter","onPointerLeave","NotCompatibleIcon","translationRecord","devices","device","join","onpointerenter","onpointerleave"],"sourceRoot":""}